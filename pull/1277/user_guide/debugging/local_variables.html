
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-LGGL0NJK6P"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-LGGL0NJK6P');
    </script>
    
    <title>Debugging Local Variables &#8212; numba-dpex  documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=bd9e20870c6007c4c509" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=bd9e20870c6007c4c509" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=bd9e20870c6007c4c509" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.5.1/css/all.min.css?digest=bd9e20870c6007c4c509" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.1/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.1/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.1/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=a746c00c" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=bd9e20870c6007c4c509" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=bd9e20870c6007c4c509" />
  <script src="../../_static/vendor/fontawesome/6.5.1/js/all.min.js?digest=bd9e20870c6007c4c509"></script>

    <script src="../../_static/documentation_options.js?v=5929fcd5"></script>
    <script src="../../_static/doctools.js?v=888ff710"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'user_guide/debugging/local_variables';</script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Debugging Features in Numba 0.55" href="numba-0.55.html" />
    <link rel="prev" title="Altering Execution" href="altering.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a id="pst-skip-link" class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>

  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <header>
  
    <div class="bd-header navbar navbar-expand-lg bd-navbar">
<div class="bd-header__inner bd-page-width">
  <label class="sidebar-toggle primary-toggle" for="__primary">
    <span class="fa-solid fa-bars"></span>
  </label>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  

<a class="navbar-brand logo" href="../../index.html">
  
  
  
  
  
  
    <p class="title logo__title">numba-dpex  documentation</p>
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav class="navbar-nav">
  <ul class="bd-navbar-elements navbar-nav">
    
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../overview.html">
                        Overview
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../getting_started.html">
                        Getting Started
                      </a>
                    </li>
                

                    <li class="nav-item current active">
                      <a class="nav-link nav-internal" href="../index.html">
                        User Guide
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../api_reference/index.html">
                        API Reference
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../contribution_guide.html">
                        Contribution Guide
                      </a>
                    </li>
                
            <li class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-controls="pst-nav-more-links">
                    More
                </button>
                <ul id="pst-nav-more-links" class="dropdown-menu">
                    
                    <li class="nav-item">
                      <a class="nav-link dropdown-item nav-internal" href="../../examples.html">
                        List of examples
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link dropdown-item nav-internal" href="../../glossary.html">
                        Glossary
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link dropdown-item nav-internal" href="../../license.html">
                        License
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link dropdown-item nav-internal" href="../../release-notes.html">
                        Release Notes
                      </a>
                    </li>
                
                </ul>
            </li>
            
  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
        </div>
      
      
        <div class="navbar-item">

<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script></div>
      
        <div class="navbar-item"><ul class="navbar-icon-links navbar-nav"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/IntelPython/numba-dpex" title="GitHub" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fab fa-github-square fa-lg" aria-hidden="true"></i></span>
            <span class="sr-only">GitHub</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://app.gitter.im/#/room/#Data-Parallel-Python_community:gitter.im" title="Gitter" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fab fa-brands fa-gitter fa-lg" aria-hidden="true"></i></span>
            <span class="sr-only">Gitter</span></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
    </div>
  

  
    <label class="sidebar-toggle secondary-toggle" for="__secondary" tabindex="0">
      <span class="fa-solid fa-outdent"></span>
    </label>
  
</div>

    </div>
  
  </header>

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          <div class="navbar-item">
<nav class="navbar-nav">
  <ul class="bd-navbar-elements navbar-nav">
    
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../overview.html">
                        Overview
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../getting_started.html">
                        Getting Started
                      </a>
                    </li>
                

                    <li class="nav-item current active">
                      <a class="nav-link nav-internal" href="../index.html">
                        User Guide
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../api_reference/index.html">
                        API Reference
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../contribution_guide.html">
                        Contribution Guide
                      </a>
                    </li>
                
            <li class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-controls="pst-nav-more-links-2">
                    More
                </button>
                <ul id="pst-nav-more-links-2" class="dropdown-menu">
                    
                    <li class="nav-item">
                      <a class="nav-link dropdown-item nav-internal" href="../../examples.html">
                        List of examples
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link dropdown-item nav-internal" href="../../glossary.html">
                        Glossary
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link dropdown-item nav-internal" href="../../license.html">
                        License
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link dropdown-item nav-internal" href="../../release-notes.html">
                        Release Notes
                      </a>
                    </li>
                
                </ul>
            </li>
            
  </ul>
</nav></div>
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script></div>
        
          <div class="navbar-item"><ul class="navbar-icon-links navbar-nav"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/IntelPython/numba-dpex" title="GitHub" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fab fa-github-square fa-lg" aria-hidden="true"></i></span>
            <span class="sr-only">GitHub</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://app.gitter.im/#/room/#Data-Parallel-Python_community:gitter.im" title="Gitter" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fab fa-brands fa-gitter fa-lg" aria-hidden="true"></i></span>
            <span class="sr-only">Gitter</span></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../programming_model.html">Programming Model</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../kernel_programming/index.html">Kernel Programming Basics</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../kernel_programming/writing_kernels.html">Writing Data Parallel Kernels</a></li>
<li class="toctree-l2"><a class="reference internal" href="../kernel_programming/synchronization.html">Synchronization Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../kernel_programming/device-functions.html">Writing Device Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../kernel_programming/atomic-operations.html">Supported Atomic Operations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../kernel_programming/memory_allocation_address_space.html">Supported Address Space Qualifiers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../kernel_programming/reduction.html">Reduction on SYCL-supported Devices</a></li>
<li class="toctree-l2"><a class="reference internal" href="../kernel_programming/ufunc.html">Universal Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../kernel_programming/supported-python-features.html">Supported Python Features inside <code class="docutils literal notranslate"><span class="pre">numba_dpex.kernel</span></code></a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../dpnp_offload.html">Compiling and Offloading <code class="docutils literal notranslate"><span class="pre">dpnp</span></code> statements</a></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="index.html">Debugging with Intel® Distribution for GDB*</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="set_up_machine.html">Set up the machine for debugging</a></li>
<li class="toctree-l2"><a class="reference internal" href="debugging_environment.html">Configure debugging environment</a></li>
<li class="toctree-l2 current active has-children"><a class="reference internal" href="features.html">Supported Features</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-3"><i class="fa-solid fa-chevron-down"></i></label><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="breakpoints.html">Breakpoints</a></li>
<li class="toctree-l3"><a class="reference internal" href="stepping.html">Stepping</a></li>
<li class="toctree-l3"><a class="reference internal" href="frame_info.html">Information About a Frame</a></li>
<li class="toctree-l3"><a class="reference internal" href="backtrace.html">Backtrace</a></li>
<li class="toctree-l3"><a class="reference internal" href="data.html">Examining Data</a></li>
<li class="toctree-l3"><a class="reference internal" href="symbols.html">Examining the Symbol Table</a></li>
<li class="toctree-l3"><a class="reference internal" href="altering.html">Altering Execution</a></li>
<li class="toctree-l3 current active"><a class="current reference internal" href="#">Debugging Local Variables</a></li>
<li class="toctree-l3"><a class="reference internal" href="numba-0.55.html">Debugging Features in Numba 0.55</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="limitations.html">Limitations</a></li>
<li class="toctree-l2"><a class="reference internal" href="common_issues.html">Common issues and tips</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../caching.html">Caching Mechanism in <code class="docutils literal notranslate"><span class="pre">numba-dpex</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../config.html">Configuration Options for <code class="docutils literal notranslate"><span class="pre">numba-dpex</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../useful_links.html">Useful links</a></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">





<nav aria-label="Breadcrumb">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="../index.html" class="nav-link">User Guide</a></li>
    
    
    <li class="breadcrumb-item"><i class="fa-solid fa-ellipsis"></i></li>
    
    
    <li class="breadcrumb-item"><a href="features.html" class="nav-link">Supported Features</a></li>
    
    <li class="breadcrumb-item active" aria-current="page">Debugging...</li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="debugging-local-variables">
<h1>Debugging Local Variables<a class="headerlink" href="#debugging-local-variables" title="Link to this heading">#</a></h1>
<p>Several conditions could influence debugging of local variables:</p>
<ol class="arabic simple">
<li><p><a class="reference internal" href="#numba-opt"><span class="std std-ref">Optimization Level for LLVM</span></a></p></li>
<li><p><a class="reference internal" href="#local-variables-lifetime"><span class="std std-ref">Local Variables Lifetime in Numba IR</span></a></p></li>
</ol>
<section id="optimization-level-for-llvm">
<span id="numba-opt"></span><h2>Optimization Level for LLVM<a class="headerlink" href="#optimization-level-for-llvm" title="Link to this heading">#</a></h2>
<p>Numba provides environment variable <code class="docutils literal notranslate"><span class="pre">NUMBA_OPT</span></code> for configuring
optimization level for LLVM. The default optimization level is three.
Refer <a class="reference external" href="https://numba.readthedocs.io/en/stable/reference/envvars.html?#envvar-NUMBA_OPT">Numba documentation</a> for details. It is recommended to debug with
<code class="samp docutils literal notranslate"><span class="pre">NUMBA_OPT=0</span></code>. The possible effect of various optimization levels may be
as follows:</p>
<ul class="simple">
<li><p><code class="samp docutils literal notranslate"><span class="pre">NUMBA_OPT=0</span></code> means “no optimization” level - all local variables are available.</p></li>
<li><p><code class="samp docutils literal notranslate"><span class="pre">NUMBA_OPT=1</span></code> or higher levels - some variables may be optimized out.</p></li>
</ul>
<section id="example">
<h3>Example<a class="headerlink" href="#example" title="Link to this heading">#</a></h3>
<p>Source code <code class="file docutils literal notranslate"><span class="pre">numba_dpex/examples/debug/sum_local_vars.py</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="linenos">11</span><span class="nd">@ndpx</span><span class="o">.</span><span class="n">kernel</span><span class="p">(</span><span class="n">debug</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="linenos">12</span><span class="k">def</span> <span class="nf">data_parallel_sum</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
<span class="linenos">13</span>    <span class="n">i</span> <span class="o">=</span> <span class="n">ndpx</span><span class="o">.</span><span class="n">get_global_id</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="linenos">14</span>    <span class="n">l1</span> <span class="o">=</span> <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="mf">2.5</span>
<span class="linenos">15</span>    <span class="n">l2</span> <span class="o">=</span> <span class="n">b</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="mf">0.3</span>
<span class="hll"><span class="linenos">16</span>    <span class="n">c</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">l1</span> <span class="o">+</span> <span class="n">l2</span>
</span></pre></div>
</div>
<p>Debug session with <code class="samp docutils literal notranslate"><span class="pre">NUMBA_OPT=0</span></code>:</p>
<div class="highlight-shell-session notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>gdb-oneapi<span class="w"> </span>-q<span class="w"> </span>python
<span class="go">...</span>
<span class="hll"><span class="gp gp-VirtualEnv">(gdb)</span> <span class="go">set environment NUMBA_OPT 0</span>
</span><span class="gp gp-VirtualEnv">(gdb)</span> <span class="go">break sum_local_vars.py:26</span>
<span class="go">...</span>
<span class="gp gp-VirtualEnv">(gdb)</span> <span class="go">run numba_dpex/examples/debug/sum_local_vars.py</span>
<span class="go">...</span>
<span class="go">Thread 2.1 hit Breakpoint 1, with SIMD lanes [0-7], __main__::data_parallel_sum (a=..., b=..., c=...) at sum_local_vars.py:26</span>
<span class="go">26          c[i] = l1 + l2</span>
<span class="hll"><span class="gp gp-VirtualEnv">(gdb)</span> <span class="go">info locals</span>
</span><span class="hll"><span class="go">i = 0</span>
</span><span class="hll"><span class="go">l1 = 2.9795852899551392</span>
</span><span class="hll"><span class="go">l2 = 0.22986688613891601</span>
</span></pre></div>
</div>
<p>It printed all local variables with their values.</p>
<p>Debug session with <code class="samp docutils literal notranslate"><span class="pre">NUMBA_OPT=1</span></code>:</p>
<div class="highlight-shell-session notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>gdb-oneapi<span class="w"> </span>-q<span class="w"> </span>python
<span class="go">...</span>
<span class="hll"><span class="gp gp-VirtualEnv">(gdb)</span> <span class="go">set environment NUMBA_OPT 1</span>
</span><span class="gp gp-VirtualEnv">(gdb)</span> <span class="go">break sum_local_vars.py:26</span>
<span class="go">...</span>
<span class="gp gp-VirtualEnv">(gdb)</span> <span class="go">run numba_dpex/examples/debug/sum_local_vars.py</span>
<span class="go">...</span>
<span class="go">Thread 2.1 hit Breakpoint 1, with SIMD lanes [0-7], ?? () at sum_local_vars.py:26 from /tmp/kernel_11059955544143858990_e6df1e.dbgelf</span>
<span class="go">26          c[i] = l1 + l2</span>
<span class="hll"><span class="gp gp-VirtualEnv">(gdb)</span> <span class="go">info locals</span>
</span><span class="hll"><span class="go">No locals.</span>
</span></pre></div>
</div>
<p>It optimized out local variables <code class="docutils literal notranslate"><span class="pre">i</span></code>, <code class="docutils literal notranslate"><span class="pre">l1</span></code> and <code class="docutils literal notranslate"><span class="pre">l2</span></code> with this optimization level.</p>
</section>
</section>
<section id="local-variables-lifetime-in-numba-ir">
<span id="local-variables-lifetime"></span><h2>Local Variables Lifetime in Numba IR<a class="headerlink" href="#local-variables-lifetime-in-numba-ir" title="Link to this heading">#</a></h2>
<p>Lifetime of Python variables are different from lifetime of variables in compiled code.
Numba analyses variables lifetime and try to optimize it.
The debugger can show the variable values, but they may be zeros
after the variable is explicitly deleted when the scope of variable is ended.</p>
<p>See <a class="reference external" href="https://numba.pydata.org/numba-doc/latest/developer/live_variable_analysis.html?highlight=delete#live-variable-analysis">Numba variable policy</a>.</p>
<p>Numba provides environment variable <code class="docutils literal notranslate"><span class="pre">NUMBA_EXTEND_VARIABLE_LIFETIMES</span></code>
for extending the lifetime of variables to the end of the block in which their lifetime ends.</p>
<p>See <a class="reference external" href="https://numba.readthedocs.io/en/stable/reference/envvars.html?#envvar-NUMBA_OPT">Numba documentation</a>.</p>
<p>Default is zero.</p>
<p>It is recommended to debug with <code class="samp docutils literal notranslate"><span class="pre">NUMBA_EXTEND_VARIABLE_LIFETIMES=1</span></code>.</p>
<section id="example-1-using-numba-extend-variable-lifetimes">
<h3>Example 1 - Using <code class="docutils literal notranslate"><span class="pre">NUMBA_EXTEND_VARIABLE_LIFETIMES</span></code><a class="headerlink" href="#example-1-using-numba-extend-variable-lifetimes" title="Link to this heading">#</a></h3>
<p>Source code <code class="file docutils literal notranslate"><span class="pre">numba_dpex/tests/debugging/test_info.py</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="linenos">14</span><span class="k">def</span> <span class="nf">common_loop_body</span><span class="p">(</span><span class="n">param_a</span><span class="p">,</span> <span class="n">param_b</span><span class="p">):</span>
<span class="linenos">15</span>    <span class="n">param_c</span> <span class="o">=</span> <span class="n">param_a</span> <span class="o">+</span> <span class="mi">10</span>  <span class="c1"># Set breakpoint here</span>
<span class="linenos">16</span>    <span class="n">param_d</span> <span class="o">=</span> <span class="n">param_b</span> <span class="o">*</span> <span class="mf">0.5</span>
<span class="linenos">17</span>    <span class="n">result</span> <span class="o">=</span> <span class="n">param_c</span> <span class="o">+</span> <span class="n">param_d</span>
<span class="hll"><span class="linenos">18</span>    <span class="k">return</span> <span class="n">result</span>
</span></pre></div>
</div>
<p>Debug session with <code class="samp docutils literal notranslate"><span class="pre">NUMBA_EXTEND_VARIABLE_LIFETIMES=1</span></code>:</p>
<div class="highlight-shell-session notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>gdb-oneapi<span class="w"> </span>-q<span class="w"> </span>python
<span class="go">...</span>
<span class="hll"><span class="gp gp-VirtualEnv">(gdb)</span> <span class="go">set environment NUMBA_EXTEND_VARIABLE_LIFETIMES 1</span>
</span><span class="gp gp-VirtualEnv">(gdb)</span> <span class="go">break side-by-side.py:28</span>
<span class="go">...</span>
<span class="gp gp-VirtualEnv">(gdb)</span> <span class="go">run numba_dpex/examples/debug/side-by-side.py --api=numba-dpex-kernel</span>
<span class="go">...</span>
<span class="go">Thread 2.1 hit Breakpoint 1, with SIMD lanes [0-7], __main__::common_loop_body (param_a=0, param_b=0) at side-by-side.py:28</span>
<span class="go">28          return result</span>
<span class="hll"><span class="gp gp-VirtualEnv">(gdb)</span> <span class="go">info locals</span>
</span><span class="hll"><span class="go">param_c = 10</span>
</span><span class="hll"><span class="go">param_d = 0</span>
</span><span class="go">result = 10</span>
</pre></div>
</div>
<p>It prints values of <code class="docutils literal notranslate"><span class="pre">param_c</span></code> and <code class="docutils literal notranslate"><span class="pre">param_d</span></code>.</p>
<p>Debug session with <code class="samp docutils literal notranslate"><span class="pre">NUMBA_EXTEND_VARIABLE_LIFETIMES=0</span></code>:</p>
<div class="highlight-shell-session notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>gdb-oneapi<span class="w"> </span>-q<span class="w"> </span>python
<span class="go">...</span>
<span class="hll"><span class="gp gp-VirtualEnv">(gdb)</span> <span class="go">set environment NUMBA_EXTEND_VARIABLE_LIFETIMES 0</span>
</span><span class="gp gp-VirtualEnv">(gdb)</span> <span class="go">break side-by-side.py:28</span>
<span class="go">...</span>
<span class="gp gp-VirtualEnv">(gdb)</span> <span class="go">run numba_dpex/examples/debug/side-by-side.py --api=numba-dpex-kernel</span>
<span class="go">...</span>
<span class="go">Thread 2.1 hit Breakpoint 1, with SIMD lanes [0-7], __main__::common_loop_body (param_a=0, param_b=0) at side-by-side.py:28</span>
<span class="go">28          return result</span>
<span class="hll"><span class="gp gp-VirtualEnv">(gdb)</span> <span class="go">info locals</span>
</span><span class="hll"><span class="go">param_c = 0</span>
</span><span class="hll"><span class="go">param_d = 0</span>
</span><span class="go">result = 10</span>
</pre></div>
</div>
</section>
<section id="example-2-using-numba-dump-annotation">
<span id="example-numba-dump-annotation"></span><h3>Example 2 - Using <code class="docutils literal notranslate"><span class="pre">NUMBA_DUMP_ANNOTATION</span></code><a class="headerlink" href="#example-2-using-numba-dump-annotation" title="Link to this heading">#</a></h3>
<p>Source code <code class="file docutils literal notranslate"><span class="pre">numba_dpex/examples/debug/sum_local_vars.py</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="linenos">11</span><span class="nd">@ndpx</span><span class="o">.</span><span class="n">kernel</span><span class="p">(</span><span class="n">debug</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="linenos">12</span><span class="k">def</span> <span class="nf">data_parallel_sum</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
<span class="linenos">13</span>    <span class="n">i</span> <span class="o">=</span> <span class="n">ndpx</span><span class="o">.</span><span class="n">get_global_id</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="linenos">14</span>    <span class="n">l1</span> <span class="o">=</span> <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="mf">2.5</span>
<span class="linenos">15</span>    <span class="n">l2</span> <span class="o">=</span> <span class="n">b</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="mf">0.3</span>
<span class="linenos">16</span>    <span class="n">c</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">l1</span> <span class="o">+</span> <span class="n">l2</span>
</pre></div>
</div>
<p>Run this code with environment variable <code class="samp docutils literal notranslate"><span class="pre">NUMBA_DUMP_ANNOTATION=1</span></code> and it
will show where numba inserts <cite>del</cite> for variables.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="o">-----------------------------------</span><span class="n">ANNOTATION</span><span class="o">-----------------------------------</span>
<span class="linenos"> 2</span><span class="c1"># File: numba_dpex/examples/debug/sum_local_vars.py</span>
<span class="linenos"> 3</span><span class="c1"># --- LINE 20 ---</span>
<span class="linenos"> 4</span>
<span class="linenos"> 5</span><span class="nd">@numba_dpex</span><span class="o">.</span><span class="n">kernel</span><span class="p">(</span><span class="n">debug</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="linenos"> 6</span>
<span class="linenos"> 7</span><span class="c1"># --- LINE 21 ---</span>
<span class="linenos"> 8</span>
<span class="linenos"> 9</span><span class="k">def</span> <span class="nf">data_parallel_sum</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
<span class="linenos">10</span>
<span class="linenos">11</span>    <span class="c1"># --- LINE 22 ---</span>
<span class="linenos">12</span>    <span class="c1"># label 0</span>
<span class="linenos">13</span>    <span class="c1">#   a = arg(0, name=a)  :: array(float32, 1d, C)</span>
<span class="linenos">14</span>    <span class="c1">#   b = arg(1, name=b)  :: array(float32, 1d, C)</span>
<span class="linenos">15</span>    <span class="c1">#   c = arg(2, name=c)  :: array(float32, 1d, C)</span>
<span class="linenos">16</span>    <span class="c1">#   $2load_global.0 = global(dpex: &lt;module &#39;numba_dpex&#39; from &#39;.../numba-dpex/numba_dpex/__init__.py&#39;&gt;)  :: Module(&lt;module &#39;numba_dpex&#39; from &#39;.../numba-dpex/numba_dpex/__init__.py&#39;&gt;)</span>
<span class="linenos">17</span>    <span class="c1">#   $4load_method.1 = getattr(value=$2load_global.0, attr=get_global_id)  :: Function(&lt;function get_global_id at 0x7f82b8bae430&gt;)</span>
<span class="linenos">18</span>    <span class="c1">#   del $2load_global.0</span>
<span class="linenos">19</span>    <span class="c1">#   $const6.2 = const(int, 0)  :: Literal[int](0)</span>
<span class="linenos">20</span>    <span class="c1">#   i = call $4load_method.1($const6.2, func=$4load_method.1, args=[Var($const6.2, sum_local_vars.py:22)], kws=(), vararg=None, target=None)  :: (uint32,) -&gt; int64</span>
<span class="linenos">21</span>    <span class="c1">#   del $const6.2</span>
<span class="linenos">22</span>    <span class="c1">#   del $4load_method.1</span>
<span class="linenos">23</span>
<span class="linenos">24</span>    <span class="n">i</span> <span class="o">=</span> <span class="n">dpex</span><span class="o">.</span><span class="n">get_global_id</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="linenos">25</span>
<span class="linenos">26</span>    <span class="c1"># --- LINE 23 ---</span>
<span class="linenos">27</span>    <span class="c1">#   $16binary_subscr.6 = getitem(value=a, index=i, fn=&lt;built-in function getitem&gt;)  :: float32</span>
<span class="hll"><span class="linenos">28</span>    <span class="c1">#   del a</span>
</span><span class="linenos">29</span>    <span class="c1">#   $const18.7 = const(float, 2.5)  :: float64</span>
<span class="linenos">30</span>    <span class="c1">#   l1 = $16binary_subscr.6 + $const18.7  :: float64</span>
<span class="linenos">31</span>    <span class="c1">#   del $const18.7</span>
<span class="linenos">32</span>    <span class="c1">#   del $16binary_subscr.6</span>
<span class="linenos">33</span>
<span class="linenos">34</span>    <span class="n">l1</span> <span class="o">=</span> <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="mf">2.5</span>
<span class="linenos">35</span>
<span class="linenos">36</span>    <span class="c1"># --- LINE 24 ---</span>
<span class="linenos">37</span>    <span class="c1">#   $28binary_subscr.11 = getitem(value=b, index=i, fn=&lt;built-in function getitem&gt;)  :: float32</span>
<span class="linenos">38</span>    <span class="c1">#   del b</span>
<span class="linenos">39</span>    <span class="c1">#   $const30.12 = const(float, 0.3)  :: float64</span>
<span class="linenos">40</span>    <span class="c1">#   l2 = $28binary_subscr.11 * $const30.12  :: float64</span>
<span class="linenos">41</span>    <span class="c1">#   del $const30.12</span>
<span class="linenos">42</span>    <span class="c1">#   del $28binary_subscr.11</span>
<span class="linenos">43</span>
<span class="linenos">44</span>    <span class="n">l2</span> <span class="o">=</span> <span class="n">b</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="mf">0.3</span>
<span class="linenos">45</span>
<span class="linenos">46</span>    <span class="c1"># --- LINE 25 ---</span>
<span class="linenos">47</span>    <span class="c1">#   $40binary_add.16 = l1 + l2  :: float64</span>
<span class="linenos">48</span>    <span class="c1">#   del l2</span>
<span class="linenos">49</span>    <span class="c1">#   del l1</span>
<span class="linenos">50</span>    <span class="c1">#   c[i] = $40binary_add.16  :: (array(float32, 1d, C), int64, float64) -&gt; none</span>
<span class="linenos">51</span>    <span class="c1">#   del i</span>
<span class="linenos">52</span>    <span class="c1">#   del c</span>
<span class="linenos">53</span>    <span class="c1">#   del $40binary_add.16</span>
<span class="linenos">54</span>    <span class="c1">#   $const48.19 = const(NoneType, None)  :: none</span>
<span class="linenos">55</span>    <span class="c1">#   $50return_value.20 = cast(value=$const48.19)  :: none</span>
<span class="linenos">56</span>    <span class="c1">#   del $const48.19</span>
<span class="linenos">57</span>    <span class="c1">#   return $50return_value.20</span>
<span class="linenos">58</span>
<span class="linenos">59</span>    <span class="n">c</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">l1</span> <span class="o">+</span> <span class="n">l2</span>
</pre></div>
</div>
<p>I.e. in <cite>LINE 23</cite> variable <cite>a</cite> used the last time and numba inserts <cite>del a</cite> as
shown in annotated code in line 28. It means you will see value 0 for the
variable <cite>a</cite> when you set breakpoint at <cite>LINE 24</cite>.</p>
<p>As a workaround you can expand lifetime of the variable by using it (i.e.
passing to dummy function <cite>revive()</cite>) at the end of the function. So numba will
not insert <cite>del a</cite> until the end of the function.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 5</span><span class="kn">import</span> <span class="nn">dpnp</span> <span class="k">as</span> <span class="nn">np</span>
<span class="linenos"> 6</span>
<span class="linenos"> 7</span><span class="kn">import</span> <span class="nn">numba_dpex</span> <span class="k">as</span> <span class="nn">ndpx</span>
<span class="linenos"> 8</span>
<span class="linenos"> 9</span>
<span class="linenos">10</span><span class="nd">@ndpx</span><span class="o">.</span><span class="n">func</span>
<span class="linenos">11</span><span class="k">def</span> <span class="nf">revive</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<span class="linenos">12</span>    <span class="k">return</span> <span class="n">x</span>
<span class="linenos">13</span>
<span class="linenos">14</span>
<span class="linenos">15</span><span class="nd">@ndpx</span><span class="o">.</span><span class="n">kernel</span><span class="p">(</span><span class="n">debug</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="linenos">16</span><span class="k">def</span> <span class="nf">data_parallel_sum</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
<span class="linenos">17</span>    <span class="n">i</span> <span class="o">=</span> <span class="n">ndpx</span><span class="o">.</span><span class="n">get_global_id</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="linenos">18</span>    <span class="n">l1</span> <span class="o">=</span> <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="mf">2.5</span>
<span class="linenos">19</span>    <span class="n">l2</span> <span class="o">=</span> <span class="n">b</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="mf">0.3</span>
<span class="linenos">20</span>    <span class="n">c</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">l1</span> <span class="o">+</span> <span class="n">l2</span>
<span class="linenos">21</span>    <span class="n">revive</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>  <span class="c1"># pass variable to dummy function</span>
<span class="linenos">22</span>
<span class="linenos">23</span>
<span class="linenos">24</span><span class="n">global_size</span> <span class="o">=</span> <span class="mi">10</span>
<span class="linenos">25</span><span class="n">N</span> <span class="o">=</span> <span class="n">global_size</span>
<span class="linenos">26</span>
<span class="linenos">27</span><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="n">N</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="linenos">28</span><span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="n">N</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="linenos">29</span><span class="n">c</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="linenos">30</span>
<span class="linenos">31</span><span class="n">data_parallel_sum</span><span class="p">[</span><span class="n">ndpx</span><span class="o">.</span><span class="n">Range</span><span class="p">(</span><span class="n">global_size</span><span class="p">)](</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span>
<span class="linenos">32</span>
<span class="linenos">33</span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Done...&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="o">-----------------------------------</span><span class="n">ANNOTATION</span><span class="o">-----------------------------------</span>
<span class="linenos"> 2</span><span class="c1"># File: numba_dpex/examples/debug/sum_local_vars_revive.py</span>
<span class="linenos"> 3</span><span class="c1"># --- LINE 24 ---</span>
<span class="linenos"> 4</span>
<span class="linenos"> 5</span><span class="nd">@numba_dpex</span><span class="o">.</span><span class="n">kernel</span><span class="p">(</span><span class="n">debug</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="linenos"> 6</span>
<span class="linenos"> 7</span><span class="c1"># --- LINE 25 ---</span>
<span class="linenos"> 8</span>
<span class="linenos"> 9</span><span class="k">def</span> <span class="nf">data_parallel_sum</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
<span class="linenos">10</span>
<span class="linenos">11</span>    <span class="c1"># --- LINE 26 ---</span>
<span class="linenos">12</span>    <span class="c1"># label 0</span>
<span class="linenos">13</span>    <span class="c1">#   a = arg(0, name=a)  :: array(float32, 1d, C)</span>
<span class="linenos">14</span>    <span class="c1">#   b = arg(1, name=b)  :: array(float32, 1d, C)</span>
<span class="linenos">15</span>    <span class="c1">#   c = arg(2, name=c)  :: array(float32, 1d, C)</span>
<span class="linenos">16</span>    <span class="c1">#   $2load_global.0 = global(dpex: &lt;module &#39;numba_dpex&#39; from &#39;.../numba-dpex/numba_dpex/__init__.py&#39;&gt;)  :: Module(&lt;module &#39;numba_dpex&#39; from &#39;.../numba-dpex/numba_dpex/__init__.py&#39;&gt;)</span>
<span class="linenos">17</span>    <span class="c1">#   $4load_method.1 = getattr(value=$2load_global.0, attr=get_global_id)  :: Function(&lt;function get_global_id at 0x7fcdf7e8c4c0&gt;)</span>
<span class="linenos">18</span>    <span class="c1">#   del $2load_global.0</span>
<span class="linenos">19</span>    <span class="c1">#   $const6.2 = const(int, 0)  :: Literal[int](0)</span>
<span class="linenos">20</span>    <span class="c1">#   i = call $4load_method.1($const6.2, func=$4load_method.1, args=[Var($const6.2, sum_local_vars_revive.py:26)], kws=(), vararg=None, target=None)  :: (uint32,) -&gt; int64</span>
<span class="linenos">21</span>    <span class="c1">#   del $const6.2</span>
<span class="linenos">22</span>    <span class="c1">#   del $4load_method.1</span>
<span class="linenos">23</span>
<span class="linenos">24</span>    <span class="n">i</span> <span class="o">=</span> <span class="n">dpex</span><span class="o">.</span><span class="n">get_global_id</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="linenos">25</span>
<span class="linenos">26</span>    <span class="c1"># --- LINE 27 ---</span>
<span class="linenos">27</span>    <span class="c1">#   $16binary_subscr.6 = getitem(value=a, index=i, fn=&lt;built-in function getitem&gt;)  :: float32</span>
<span class="linenos">28</span>    <span class="c1">#   $const18.7 = const(float, 2.5)  :: float64</span>
<span class="linenos">29</span>    <span class="c1">#   l1 = $16binary_subscr.6 + $const18.7  :: float64</span>
<span class="linenos">30</span>    <span class="c1">#   del $const18.7</span>
<span class="linenos">31</span>    <span class="c1">#   del $16binary_subscr.6</span>
<span class="linenos">32</span>
<span class="linenos">33</span>    <span class="n">l1</span> <span class="o">=</span> <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="mf">2.5</span>
<span class="linenos">34</span>
<span class="linenos">35</span>    <span class="c1"># --- LINE 28 ---</span>
<span class="linenos">36</span>    <span class="c1">#   $28binary_subscr.11 = getitem(value=b, index=i, fn=&lt;built-in function getitem&gt;)  :: float32</span>
<span class="linenos">37</span>    <span class="c1">#   del b</span>
<span class="linenos">38</span>    <span class="c1">#   $const30.12 = const(float, 0.3)  :: float64</span>
<span class="linenos">39</span>    <span class="c1">#   l2 = $28binary_subscr.11 * $const30.12  :: float64</span>
<span class="linenos">40</span>    <span class="c1">#   del $const30.12</span>
<span class="linenos">41</span>    <span class="c1">#   del $28binary_subscr.11</span>
<span class="linenos">42</span>
<span class="linenos">43</span>    <span class="n">l2</span> <span class="o">=</span> <span class="n">b</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="mf">0.3</span>
<span class="linenos">44</span>
<span class="linenos">45</span>    <span class="c1"># --- LINE 29 ---</span>
<span class="linenos">46</span>    <span class="c1">#   $40binary_add.16 = l1 + l2  :: float64</span>
<span class="linenos">47</span>    <span class="c1">#   del l2</span>
<span class="linenos">48</span>    <span class="c1">#   del l1</span>
<span class="linenos">49</span>    <span class="c1">#   c[i] = $40binary_add.16  :: (array(float32, 1d, C), int64, float64) -&gt; none</span>
<span class="linenos">50</span>    <span class="c1">#   del i</span>
<span class="linenos">51</span>    <span class="c1">#   del c</span>
<span class="linenos">52</span>    <span class="c1">#   del $40binary_add.16</span>
<span class="linenos">53</span>
<span class="linenos">54</span>    <span class="n">c</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">l1</span> <span class="o">+</span> <span class="n">l2</span>
<span class="linenos">55</span>
<span class="linenos">56</span>    <span class="c1"># --- LINE 30 ---</span>
<span class="linenos">57</span>    <span class="c1">#   $48load_global.19 = global(revive: &lt;numba_dpex.compiler.DpexFunctionTemplate object at 0x7fce12e5cc40&gt;)  :: Function(&lt;numba_dpex.compiler.DpexFunctionTemplate object at 0x7fce12e5cc40&gt;)</span>
<span class="linenos">58</span>    <span class="c1">#   $52call_function.21 = call $48load_global.19(a, func=$48load_global.19, args=[Var(a, sum_local_vars_revive.py:26)], kws=(), vararg=None, target=None)  :: (array(float32, 1d, C),) -&gt; array(float32, 1d, C)</span>
<span class="hll"><span class="linenos">59</span>    <span class="c1">#   del a</span>
</span><span class="linenos">60</span>    <span class="c1">#   del $52call_function.21</span>
<span class="linenos">61</span>    <span class="c1">#   del $48load_global.19</span>
<span class="linenos">62</span>    <span class="c1">#   $const56.22 = const(NoneType, None)  :: none</span>
<span class="linenos">63</span>    <span class="c1">#   $58return_value.23 = cast(value=$const56.22)  :: none</span>
<span class="linenos">64</span>    <span class="c1">#   del $const56.22</span>
<span class="linenos">65</span>    <span class="c1">#   return $58return_value.23</span>
<span class="linenos">66</span>
<span class="linenos">67</span>    <span class="n">revive</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>  <span class="c1"># pass variable to dummy function</span>
</pre></div>
</div>
<p>Run with environment variables <code class="samp docutils literal notranslate"><span class="pre">NUMBA_DUMP_ANNOTATION=1</span></code> and
<code class="samp docutils literal notranslate"><span class="pre">NUMBA_EXTEND_VARIABLE_LIFETIMES=1</span></code>.
It will show that numba inserts <cite>del</cite> for variables at the end of the block:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="o">-----------------------------------</span><span class="n">ANNOTATION</span><span class="o">-----------------------------------</span>
<span class="linenos"> 2</span><span class="c1"># File: numba_dpex/examples/debug/sum_local_vars.py</span>
<span class="linenos"> 3</span><span class="o">...</span>
<span class="linenos"> 4</span><span class="k">def</span> <span class="nf">data_parallel_sum</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
<span class="linenos"> 5</span>    <span class="o">...</span>
<span class="linenos"> 6</span>    <span class="c1"># --- LINE 26 ---</span>
<span class="linenos"> 7</span>    <span class="c1">#   $40binary_add.16 = l1 + l2  :: float64</span>
<span class="linenos"> 8</span>    <span class="c1">#   c[i] = $40binary_add.16  :: (array(float32, 1d, C), int64, float64) -&gt; none</span>
<span class="linenos"> 9</span>    <span class="c1">#   $const48.19 = const(NoneType, None)  :: none</span>
<span class="linenos">10</span>    <span class="c1">#   $50return_value.20 = cast(value=$const48.19)  :: none</span>
<span class="hll"><span class="linenos">11</span>    <span class="c1">#   del $2load_global.0</span>
</span><span class="hll"><span class="linenos">12</span>    <span class="c1">#   del $const6.2</span>
</span><span class="hll"><span class="linenos">13</span>    <span class="c1">#   del $4load_method.1</span>
</span><span class="hll"><span class="linenos">14</span>    <span class="c1">#   del a</span>
</span><span class="hll"><span class="linenos">15</span>    <span class="c1">#   del $const18.7</span>
</span><span class="hll"><span class="linenos">16</span>    <span class="c1">#   del $16binary_subscr.6</span>
</span><span class="hll"><span class="linenos">17</span>    <span class="c1">#   del b</span>
</span><span class="hll"><span class="linenos">18</span>    <span class="c1">#   del $const30.12</span>
</span><span class="hll"><span class="linenos">19</span>    <span class="c1">#   del $28binary_subscr.11</span>
</span><span class="hll"><span class="linenos">20</span>    <span class="c1">#   del l2</span>
</span><span class="hll"><span class="linenos">21</span>    <span class="c1">#   del l1</span>
</span><span class="hll"><span class="linenos">22</span>    <span class="c1">#   del i</span>
</span><span class="hll"><span class="linenos">23</span>    <span class="c1">#   del c</span>
</span><span class="hll"><span class="linenos">24</span>    <span class="c1">#   del $40binary_add.16</span>
</span><span class="hll"><span class="linenos">25</span>    <span class="c1">#   del $const48.19</span>
</span><span class="linenos">26</span>    <span class="c1">#   return $50return_value.20</span>
<span class="linenos">27</span>
<span class="linenos">28</span>    <span class="n">c</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">l1</span> <span class="o">+</span> <span class="n">l2</span>
</pre></div>
</div>
</section>
<section id="example-3-using-info-locals">
<h3>Example 3 - Using <code class="docutils literal notranslate"><span class="pre">info</span> <span class="pre">locals</span></code><a class="headerlink" href="#example-3-using-info-locals" title="Link to this heading">#</a></h3>
<p>Source code <code class="file docutils literal notranslate"><span class="pre">sum_local_vars.py</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 5</span><span class="kn">import</span> <span class="nn">dpctl</span>
<span class="linenos"> 6</span><span class="kn">import</span> <span class="nn">dpnp</span> <span class="k">as</span> <span class="nn">np</span>
<span class="linenos"> 7</span>
<span class="linenos"> 8</span><span class="kn">import</span> <span class="nn">numba_dpex</span> <span class="k">as</span> <span class="nn">ndpx</span>
<span class="linenos"> 9</span>
<span class="linenos">10</span>
<span class="linenos">11</span><span class="nd">@ndpx</span><span class="o">.</span><span class="n">kernel</span><span class="p">(</span><span class="n">debug</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="linenos">12</span><span class="k">def</span> <span class="nf">data_parallel_sum</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
<span class="linenos">13</span>    <span class="n">i</span> <span class="o">=</span> <span class="n">ndpx</span><span class="o">.</span><span class="n">get_global_id</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="linenos">14</span>    <span class="n">l1</span> <span class="o">=</span> <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="mf">2.5</span>
<span class="linenos">15</span>    <span class="n">l2</span> <span class="o">=</span> <span class="n">b</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="mf">0.3</span>
<span class="linenos">16</span>    <span class="n">c</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">l1</span> <span class="o">+</span> <span class="n">l2</span>
<span class="linenos">17</span>
<span class="linenos">18</span>
<span class="linenos">19</span><span class="n">global_size</span> <span class="o">=</span> <span class="mi">10</span>
<span class="linenos">20</span><span class="n">N</span> <span class="o">=</span> <span class="n">global_size</span>
<span class="linenos">21</span>
<span class="linenos">22</span><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="n">N</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="linenos">23</span><span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="n">N</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="linenos">24</span><span class="n">c</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="linenos">25</span>
<span class="linenos">26</span><span class="n">data_parallel_sum</span><span class="p">[</span><span class="n">ndpx</span><span class="o">.</span><span class="n">Range</span><span class="p">(</span><span class="n">global_size</span><span class="p">)](</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span>
<span class="linenos">27</span>
<span class="linenos">28</span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Done...&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Run the debugger with <code class="docutils literal notranslate"><span class="pre">NUMBA_OPT=0</span></code>:</p>
<div class="highlight-shell-session notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span><span class="nv">NUMBA_OPT</span><span class="o">=</span><span class="m">0</span><span class="w"> </span>gdb-oneapi<span class="w"> </span>-q<span class="w"> </span>python
<span class="gp gp-VirtualEnv">(gdb)</span> <span class="go">set breakpoint pending on</span>
<span class="gp gp-VirtualEnv">(gdb)</span> <span class="go">break sum_local_vars.py:22</span>
<span class="gp gp-VirtualEnv">(gdb)</span> <span class="go">run sum_local_vars.py</span>
<span class="go">...</span>
<span class="go">Thread 2.2 hit Breakpoint 1, with SIMD lanes [0-7], __main__::data_parallel_sum () at sum_local_vars.py:22</span>
</pre></div>
</div>
<p>Run the <code class="docutils literal notranslate"><span class="pre">info</span> <span class="pre">locals</span></code> command. The sample output on “no optimization” level <code class="docutils literal notranslate"><span class="pre">NUMBA_OPT=0</span></code> is as follows:</p>
<div class="highlight-shell-session notranslate"><div class="highlight"><pre><span></span><span class="hll"><span class="gp gp-VirtualEnv">(gdb)</span> <span class="go">info locals</span>
</span><span class="hll"><span class="go">a = &#39;\000&#39; &lt;repeats 55 times&gt;</span>
</span><span class="hll"><span class="go">b = &#39;\000&#39; &lt;repeats 55 times&gt;</span>
</span><span class="hll"><span class="go">c = &#39;\000&#39; &lt;repeats 55 times&gt;</span>
</span><span class="hll"><span class="go">i = 0</span>
</span><span class="hll"><span class="go">l1 = 0</span>
</span><span class="hll"><span class="go">l2 = 0</span>
</span><span class="hll"><span class="go">__ocl_dbg_gid0 = 0</span>
</span><span class="hll"><span class="go">__ocl_dbg_gid1 = 0</span>
</span><span class="hll"><span class="go">__ocl_dbg_gid2 = 0</span>
</span><span class="hll"><span class="go">__ocl_dbg_lid0 = 0</span>
</span><span class="hll"><span class="go">__ocl_dbg_lid1 = 0</span>
</span><span class="hll"><span class="go">__ocl_dbg_lid2 = 0</span>
</span><span class="hll"><span class="go">__ocl_dbg_grid0 = 0</span>
</span><span class="hll"><span class="go">__ocl_dbg_grid1 = 0</span>
</span><span class="hll"><span class="go">__ocl_dbg_grid2 = 0</span>
</span><span class="gp gp-VirtualEnv">(gdb)</span> <span class="go">next</span>
<span class="go">Thread 2.3 hit Breakpoint 1, with SIMD lanes [0-1], __main__::data_parallel_sum () at sum_local_vars.py:22</span>
<span class="go">22          i = dpex.get_global_id(0)</span>
<span class="gp gp-VirtualEnv">(gdb)</span> <span class="go">next</span>
<span class="go">23          l1 = a[i] + 2.5</span>
<span class="gp gp-VirtualEnv">(gdb)</span> <span class="go">next</span>
<span class="go">24          l2 = b[i] * 0.3</span>
<span class="hll"><span class="gp gp-VirtualEnv">(gdb)</span> <span class="go">info locals</span>
</span><span class="hll"><span class="go">a = &#39;\000&#39; &lt;repeats 55 times&gt;</span>
</span><span class="hll"><span class="go">b = &#39;\000&#39; &lt;repeats 16 times&gt;, &quot;\n\000\000\000\000\000\000\000\004\000\000\000\000\000\000\000\000\240\016XUU\000\000\n\000\000\000\000\000\000\000\004\000\000\000\000\000\000&quot;</span>
</span><span class="hll"><span class="go">c = &#39;\000&#39; &lt;repeats 16 times&gt;, &quot;\n\000\000\000\000\000\000\000\004\000\000\000\000\000\000\000\000@\256WUU\000\000\n\000\000\000\000\000\000\000\004\000\000\000\000\000\000&quot;</span>
</span><span class="hll"><span class="go">i = 8</span>
</span><span class="hll"><span class="go">l1 = 2.5931931659579277</span>
</span><span class="hll"><span class="go">l2 = 0</span>
</span><span class="hll"><span class="go">__ocl_dbg_gid0 = 0</span>
</span><span class="hll"><span class="go">__ocl_dbg_gid1 = 0</span>
</span><span class="hll"><span class="go">__ocl_dbg_gid2 = 0</span>
</span><span class="hll"><span class="go">__ocl_dbg_lid0 = 42949672970</span>
</span><span class="hll"><span class="go">__ocl_dbg_lid1 = 0</span>
</span><span class="hll"><span class="go">__ocl_dbg_lid2 = 93825037590528</span>
</span><span class="hll"><span class="go">__ocl_dbg_grid0 = 4612811918334230528</span>
</span><span class="hll"><span class="go">__ocl_dbg_grid1 = 0</span>
</span><span class="hll"><span class="go">__ocl_dbg_grid2 = 0</span>
</span><span class="gp gp-VirtualEnv">(gdb)</span> <span class="go">next</span>
<span class="go">25          c[i] = l1 + l2</span>
</pre></div>
</div>
<p>Since the debugger does not hit a line with the target variable <code class="docutils literal notranslate"><span class="pre">l1</span></code>, the value equals 0. The true value of the variable <code class="docutils literal notranslate"><span class="pre">l1</span></code> is shown after stepping to line 22.</p>
<div class="highlight-shell-session notranslate"><div class="highlight"><pre><span></span><span class="hll"><span class="gp gp-VirtualEnv">(gdb)</span> <span class="go">info locals</span>
</span><span class="hll"><span class="go">a = &#39;\000&#39; &lt;repeats 55 times&gt;</span>
</span><span class="hll"><span class="go">b = &#39;\000&#39; &lt;repeats 55 times&gt;</span>
</span><span class="hll"><span class="go">c = &#39;\000&#39; &lt;repeats 16 times&gt;, &quot;\n\000\000\000\000\000\000\000\004\000\000\000\000\000\000\000\000@\256WUU\000\000\n\000\000\000\000\000\000\000\004\000\000\000\000\000\000&quot;</span>
</span><span class="hll"><span class="go">i = 8</span>
</span><span class="hll"><span class="go">l1 = 2.5931931659579277</span>
</span><span class="hll"><span class="go">l2 = 0.22954882979393004</span>
</span><span class="hll"><span class="go">__ocl_dbg_gid0 = 0</span>
</span><span class="hll"><span class="go">__ocl_dbg_gid1 = 8</span>
</span><span class="hll"><span class="go">__ocl_dbg_gid2 = 8</span>
</span><span class="hll"><span class="go">__ocl_dbg_lid0 = 93825034429928</span>
</span><span class="hll"><span class="go">__ocl_dbg_lid1 = 0</span>
</span><span class="hll"><span class="go">__ocl_dbg_lid2 = 93825034429936</span>
</span><span class="hll"><span class="go">__ocl_dbg_grid0 = 4599075939470750515</span>
</span><span class="hll"><span class="go">__ocl_dbg_grid1 = 0</span>
</span><span class="hll"><span class="go">__ocl_dbg_grid2 = 0</span>
</span><span class="gp gp-VirtualEnv">(gdb)</span> <span class="go">print a</span>
<span class="gp">$</span><span class="nv">1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;\000&#39;</span><span class="w"> </span>&lt;repeats<span class="w"> </span><span class="m">55</span><span class="w"> </span>times&gt;
</pre></div>
</div>
<p>When the debugger hits the last line of the kernel, <code class="docutils literal notranslate"><span class="pre">info</span> <span class="pre">locals</span></code> command returns all the local variables with their values.</p>
</section>
</section>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="altering.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Altering Execution</p>
      </div>
    </a>
    <a class="right-next"
       href="numba-0.55.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Debugging Features in Numba 0.55</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#optimization-level-for-llvm">Optimization Level for LLVM</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#example">Example</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#local-variables-lifetime-in-numba-ir">Local Variables Lifetime in Numba IR</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#example-1-using-numba-extend-variable-lifetimes">Example 1 - Using <code class="docutils literal notranslate"><span class="pre">NUMBA_EXTEND_VARIABLE_LIFETIMES</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#example-2-using-numba-dump-annotation">Example 2 - Using <code class="docutils literal notranslate"><span class="pre">NUMBA_DUMP_ANNOTATION</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#example-3-using-info-locals">Example 3 - Using <code class="docutils literal notranslate"><span class="pre">info</span> <span class="pre">locals</span></code></a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=bd9e20870c6007c4c509"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=bd9e20870c6007c4c509"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright 2020-2023, Intel Corporation.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.2.6.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.15.1.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>