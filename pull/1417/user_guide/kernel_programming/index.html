<!doctype html>
<html class="no-js" lang="en" data-content_root="../../">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />

    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-LGGL0NJK6P"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-LGGL0NJK6P');
    </script>
    <link rel="index" title="Index" href="../../genindex.html" /><link rel="search" title="Search" href="../../search.html" /><link rel="next" title="Debugging with Intel® Distribution for GDB*" href="../debugging/index.html" /><link rel="prev" title="Tutorials" href="../index.html" />

    <!-- Generated with Sphinx 7.2.6 and Furo 2024.01.29 -->
        <title>Kernel Programming - numba-dpex documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/furo.css?v=135e06be" />
    <link rel="stylesheet" type="text/css" href="../../_static/graphviz.css?v=eafc0fe6" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/furo-extensions.css?v=36a5483c" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/custom.css" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../../index.html"><div class="brand">numba-dpex  documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../../index.html">
  
  
  <span class="sidebar-brand-text">numba-dpex  documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="../../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../getting_started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../programming_model.html">Programming Model</a></li>
<li class="toctree-l1 current has-children"><a class="reference internal" href="../index.html">Tutorials</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of Tutorials</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2 current current-page"><a class="current reference internal" href="#">Kernel Programming</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../debugging/index.html">Debugging with Intel® Distribution for GDB*</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle navigation of Debugging with Intel® Distribution for GDB*</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../debugging/set_up_machine.html">Set up the machine for debugging</a></li>
<li class="toctree-l3"><a class="reference internal" href="../debugging/debugging_environment.html">Configure debugging environment</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../debugging/features.html">Supported Features</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle navigation of Supported Features</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../debugging/breakpoints.html">Breakpoints</a></li>
<li class="toctree-l4"><a class="reference internal" href="../debugging/stepping.html">Stepping</a></li>
<li class="toctree-l4"><a class="reference internal" href="../debugging/frame_info.html">Information About a Frame</a></li>
<li class="toctree-l4"><a class="reference internal" href="../debugging/backtrace.html">Backtrace</a></li>
<li class="toctree-l4"><a class="reference internal" href="../debugging/data.html">Examining Data</a></li>
<li class="toctree-l4"><a class="reference internal" href="../debugging/symbols.html">Examining the Symbol Table</a></li>
<li class="toctree-l4"><a class="reference internal" href="../debugging/altering.html">Altering Execution</a></li>
<li class="toctree-l4"><a class="reference internal" href="../debugging/local_variables.html">Debugging Local Variables</a></li>
<li class="toctree-l4"><a class="reference internal" href="../debugging/numba-0.55.html">Debugging Features in Numba 0.55</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../debugging/limitations.html">Limitations</a></li>
<li class="toctree-l3"><a class="reference internal" href="../debugging/common_issues.html">Common issues and tips</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../config.html">Configuration Options for <code class="docutils literal notranslate"><span class="pre">numba-dpex</span></code></a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../autoapi/index.html">API Reference</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><div class="visually-hidden">Toggle navigation of API Reference</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../autoapi/numba_dpex/kernel_api/index.html">numba_dpex.kernel_api</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../autoapi/numba_dpex/core/decorators/index.html">numba_dpex.core.decorators</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../autoapi/numba_dpex/core/kernel_launcher/index.html">numba_dpex.core.kernel_launcher</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../supported_sycl_features.html">SYCL* and numba-dpex Feature Comparison</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../experimental/index.html">Experimental Features</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../useful_links.html">Useful links</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Development</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../contribution_guide.html">Contribution Guide</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Misc Notes</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../examples.html">List of examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../license.html">License</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../release-notes.html">Release Notes</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <span class="target" id="kernel-programming-guide"></span><section id="kernel-programming">
<h1>Kernel Programming<a class="headerlink" href="#kernel-programming" title="Link to this heading">#</a></h1>
<p>The tutorial covers the numba-dpex kernel programming API (kapi) and introduces
the concepts needed to write data-parallel kernels in numba-dpex.</p>
<section id="core-concepts">
<h2>Core concepts<a class="headerlink" href="#core-concepts" title="Link to this heading">#</a></h2>
<section id="writing-a-range-kernel">
<h3>Writing a <em>range</em> kernel<a class="headerlink" href="#writing-a-range-kernel" title="Link to this heading">#</a></h3>
<p>A <em>range</em> kernel represents the simplest form of parallelism that can be
expressed in numba-dpex using kapi. Such a kernel represents a data-parallel
execution over a set of work-items with each work-item representing a logical
thread of execution. <a class="reference internal" href="writing-range-kernel.html#ex-vecadd-kernel"><span class="std std-ref">Example: Vector addition using a range kernel</span></a> shows an example of a range kernel
written in numba-dpex.</p>
<div class="literal-block-wrapper docutils container" id="ex-vecadd-kernel">
<div class="code-block-caption"><span class="caption-text"><strong>Example:</strong> Vector addition using a range kernel</span><a class="headerlink" href="#ex-vecadd-kernel" title="Link to this code">#</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="kn">import</span> <span class="nn">dpnp</span>
<span class="linenos"> 2</span><span class="kn">import</span> <span class="nn">numba_dpex</span> <span class="k">as</span> <span class="nn">dpex</span>
<span class="linenos"> 3</span><span class="kn">from</span> <span class="nn">numba_dpex</span> <span class="kn">import</span> <span class="n">kernel_api</span> <span class="k">as</span> <span class="n">kapi</span>
<span class="linenos"> 4</span>
<span class="linenos"> 5</span>
<span class="linenos"> 6</span><span class="c1"># Data parallel kernel implementing vector sum</span>
<span class="linenos"> 7</span><span class="nd">@dpex</span><span class="o">.</span><span class="n">kernel</span>
<span class="linenos"> 8</span><span class="k">def</span> <span class="nf">vecadd</span><span class="p">(</span><span class="n">item</span><span class="p">:</span> <span class="n">kapi</span><span class="o">.</span><span class="n">Item</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
<span class="hll"><span class="linenos"> 9</span>    <span class="n">i</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="n">get_id</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span class="linenos">10</span>    <span class="n">c</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">b</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
<span class="linenos">11</span>
<span class="linenos">12</span>
<span class="linenos">13</span><span class="n">N</span> <span class="o">=</span> <span class="mi">1024</span>
<span class="linenos">14</span><span class="n">a</span> <span class="o">=</span> <span class="n">dpnp</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
<span class="linenos">15</span><span class="n">b</span> <span class="o">=</span> <span class="n">dpnp</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="linenos">16</span><span class="n">c</span> <span class="o">=</span> <span class="n">dpnp</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="hll"><span class="linenos">17</span><span class="n">dpex</span><span class="o">.</span><span class="n">call_kernel</span><span class="p">(</span><span class="n">vecadd</span><span class="p">,</span> <span class="n">kapi</span><span class="o">.</span><span class="n">Range</span><span class="p">(</span><span class="n">N</span><span class="p">),</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span>
</span></pre></div>
</div>
</div>
<p>The highlighted lines in the example demonstrate the definition of the execution
range on <strong>line 17</strong> and extraction of every work-items’ <em>id</em> or index position
via the <code class="docutils literal notranslate"><span class="pre">item.get_id</span></code> call on <strong>line 10</strong>. An execution range comprising of
1024 work-items is defined when calling the kernel and each work-item then
executes a single addition.</p>
<p>There are a few semantic rules that have to be adhered to when writing a range
kernel:</p>
<ul>
<li><p>Analogous to the API of SYCL a range kernel can execute only over a 1-, 2-, or
a 3-dimensional set of work-items.</p></li>
<li><p>Every range kernel requires its first argument to be an instance of the
<a class="reference internal" href="../../autoapi/numba_dpex/kernel_api/index.html#numba_dpex.kernel_api.Item" title="numba_dpex.kernel_api.Item"><code class="xref py py-class docutils literal notranslate"><span class="pre">numba_dpex.kernel_api.Item</span></code></a> class. The <code class="docutils literal notranslate"><span class="pre">Item</span></code> object is an
abstraction encapsulating the index position (id) of a single work-item in the
global execution range. The id will be a 1-, 2-, or a 3-tuple depending
the dimensionality of the execution range.</p></li>
<li><p>A range kernel cannot return any value.</p>
<p><strong>Note</strong> the rule is enforced only in
the compiled mode and not in the pure Python execution on a kapi kernel.</p>
</li>
<li><p>A kernel can accept both array and scalar arguments. Array arguments currently
can either be a <code class="docutils literal notranslate"><span class="pre">dpnp.ndarray</span></code> or a <code class="docutils literal notranslate"><span class="pre">dpctl.tensor.usm_ndarray</span></code>. Scalar
values can be of any Python numeric type. Array arguments are passed by
reference, <em>i.e.</em>, changes to an array in a kernel are visible outside the
kernel. Scalar values are always passed by value.</p></li>
<li><p>At least one argument of a kernel should be an array. The requirement is so
that the kernel launcher (<a class="reference internal" href="../../autoapi/numba_dpex/core/kernel_launcher/index.html#numba_dpex.core.kernel_launcher.call_kernel" title="numba_dpex.core.kernel_launcher.call_kernel"><code class="xref py py-func docutils literal notranslate"><span class="pre">numba_dpex.core.kernel_launcher.call_kernel()</span></code></a>)
can determine the execution queue on which to launch the kernel. Refer to the
<a class="reference internal" href="#launching-a-kernel"><span class="std std-ref">Launching a kernel</span></a> section for more details.</p></li>
</ul>
<p>A range kernel has to be executed via the
<a class="reference internal" href="../../autoapi/numba_dpex/core/kernel_launcher/index.html#numba_dpex.core.kernel_launcher.call_kernel" title="numba_dpex.core.kernel_launcher.call_kernel"><code class="xref py py-func docutils literal notranslate"><span class="pre">numba_dpex.core.kernel_launcher.call_kernel()</span></code></a> function by passing in
an instance of the <a class="reference internal" href="../../autoapi/numba_dpex/kernel_api/index.html#numba_dpex.kernel_api.Range" title="numba_dpex.kernel_api.Range"><code class="xref py py-class docutils literal notranslate"><span class="pre">numba_dpex.kernel_api.Range</span></code></a> class. Refer to the
<a class="reference internal" href="#launching-a-kernel"><span class="std std-ref">Launching a kernel</span></a> section for more details on how to launch a range
kernel.</p>
<p>A range kernel is meant to express a basic <cite>parallel-for</cite> calculation that is
ideally suited for embarrassingly parallel kernels such as element-wise
computations over n-dimensional arrays (ndarrays). The API for expressing a
range kernel does not allow advanced features such as synchronization of
work-items and fine-grained control over memory allocation on a device. For such
advanced features, an nd-range kernel should be used.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>Refer API documentation for <a class="reference internal" href="../../autoapi/numba_dpex/kernel_api/index.html#numba_dpex.kernel_api.Range" title="numba_dpex.kernel_api.Range"><code class="xref py py-class docutils literal notranslate"><span class="pre">numba_dpex.kernel_api.Range</span></code></a>,
<a class="reference internal" href="../../autoapi/numba_dpex/kernel_api/index.html#numba_dpex.kernel_api.Item" title="numba_dpex.kernel_api.Item"><code class="xref py py-class docutils literal notranslate"><span class="pre">numba_dpex.kernel_api.Item</span></code></a>,  and
<a class="reference internal" href="../../autoapi/numba_dpex/core/kernel_launcher/index.html#numba_dpex.core.kernel_launcher.call_kernel" title="numba_dpex.core.kernel_launcher.call_kernel"><code class="xref py py-func docutils literal notranslate"><span class="pre">numba_dpex.core.kernel_launcher.call_kernel()</span></code></a> for more details.</p>
</div>
</section>
<section id="writing-an-nd-range-kernel">
<h3>Writing an <em>nd-range</em> kernel<a class="headerlink" href="#writing-an-nd-range-kernel" title="Link to this heading">#</a></h3>
<p>In a range kernel, the kernel execution is scheduled over a set of work-items
without any explicit grouping of the work-items. The basic form of parallelism
that can be expressed using a range kernel does not allow expressing any notion
of locality within the kernel. To get around that limitation, kapi provides a
second form of expressing a parallel kernel that is called an <em>nd-range</em> kernel.
An nd-range kernel represents a data-parallel execution of the kernel by a set
of explicitly defined groups of work-items. An individual group of work-items is
called a <em>work-group</em>. <a class="reference internal" href="writing-ndrange-kernel.html#ex-matmul-kernel"><span class="std std-ref">Example: Sliding window matrix multiplication as an nd-range kernel</span></a> demonstrates an nd-range kernel
and some of the advanced features programmers can use in this type of kernel.</p>
<div class="literal-block-wrapper docutils container" id="ex-matmul-kernel">
<div class="code-block-caption"><span class="caption-text"><strong>Example:</strong> Sliding window matrix multiplication as an nd-range kernel</span><a class="headerlink" href="#ex-matmul-kernel" title="Link to this code">#</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="kn">from</span> <span class="nn">numba_dpex</span> <span class="kn">import</span> <span class="n">kernel_api</span> <span class="k">as</span> <span class="n">kapi</span>
<span class="linenos"> 2</span><span class="kn">import</span> <span class="nn">numba_dpex</span> <span class="k">as</span> <span class="nn">dpex</span>
<span class="linenos"> 3</span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="linenos"> 4</span><span class="kn">import</span> <span class="nn">dpctl.tensor</span> <span class="k">as</span> <span class="nn">dpt</span>
<span class="linenos"> 5</span>
<span class="linenos"> 6</span><span class="n">square_block_side</span> <span class="o">=</span> <span class="mi">2</span>
<span class="linenos"> 7</span><span class="n">work_group_size</span> <span class="o">=</span> <span class="p">(</span><span class="n">square_block_side</span><span class="p">,</span> <span class="n">square_block_side</span><span class="p">)</span>
<span class="linenos"> 8</span><span class="n">dtype</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">float32</span>
<span class="linenos"> 9</span>
<span class="linenos">10</span>
<span class="linenos">11</span><span class="nd">@dpex</span><span class="o">.</span><span class="n">kernel</span>
<span class="linenos">12</span><span class="k">def</span> <span class="nf">matmul</span><span class="p">(</span>
<span class="linenos">13</span>    <span class="n">nditem</span><span class="p">:</span> <span class="n">kapi</span><span class="o">.</span><span class="n">NdItem</span><span class="p">,</span>
<span class="linenos">14</span>    <span class="n">X</span><span class="p">,</span>  <span class="c1"># IN READ-ONLY    (X_n_rows, n_cols)</span>
<span class="linenos">15</span>    <span class="n">y</span><span class="p">,</span>  <span class="c1"># IN READ-ONLY    (n_cols, y_n_rows),</span>
<span class="linenos">16</span>    <span class="n">X_slm</span><span class="p">,</span>  <span class="c1"># SLM to store a sliding window over X</span>
<span class="linenos">17</span>    <span class="n">Y_slm</span><span class="p">,</span>  <span class="c1"># SLM to store a sliding window over Y</span>
<span class="linenos">18</span>    <span class="n">result</span><span class="p">,</span>  <span class="c1"># OUT        (X_n_rows, y_n_rows)</span>
<span class="linenos">19</span><span class="p">):</span>
<span class="linenos">20</span>    <span class="n">X_n_rows</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="linenos">21</span>    <span class="n">Y_n_cols</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="linenos">22</span>    <span class="n">n_cols</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="linenos">23</span>
<span class="linenos">24</span>    <span class="n">result_row_idx</span> <span class="o">=</span> <span class="n">nditem</span><span class="o">.</span><span class="n">get_global_id</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="linenos">25</span>    <span class="n">result_col_idx</span> <span class="o">=</span> <span class="n">nditem</span><span class="o">.</span><span class="n">get_global_id</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="linenos">26</span>
<span class="linenos">27</span>    <span class="n">local_row_idx</span> <span class="o">=</span> <span class="n">nditem</span><span class="o">.</span><span class="n">get_local_id</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="linenos">28</span>    <span class="n">local_col_idx</span> <span class="o">=</span> <span class="n">nditem</span><span class="o">.</span><span class="n">get_local_id</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="linenos">29</span>
<span class="linenos">30</span>    <span class="n">n_blocks_for_cols</span> <span class="o">=</span> <span class="n">n_cols</span> <span class="o">//</span> <span class="n">square_block_side</span>
<span class="linenos">31</span>    <span class="k">if</span> <span class="p">(</span><span class="n">n_cols</span> <span class="o">%</span> <span class="n">square_block_side</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
<span class="linenos">32</span>        <span class="n">n_blocks_for_cols</span> <span class="o">+=</span> <span class="mi">1</span>
<span class="linenos">33</span>
<span class="linenos">34</span>    <span class="n">output</span> <span class="o">=</span> <span class="n">dtype</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="linenos">35</span>
<span class="linenos">36</span>    <span class="n">gr</span> <span class="o">=</span> <span class="n">nditem</span><span class="o">.</span><span class="n">get_group</span><span class="p">()</span>
<span class="linenos">37</span>
<span class="linenos">38</span>    <span class="k">for</span> <span class="n">block_idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_blocks_for_cols</span><span class="p">):</span>
<span class="linenos">39</span>        <span class="n">X_slm</span><span class="p">[</span><span class="n">local_row_idx</span><span class="p">,</span> <span class="n">local_col_idx</span><span class="p">]</span> <span class="o">=</span> <span class="n">dtype</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="linenos">40</span>        <span class="n">Y_slm</span><span class="p">[</span><span class="n">local_row_idx</span><span class="p">,</span> <span class="n">local_col_idx</span><span class="p">]</span> <span class="o">=</span> <span class="n">dtype</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="linenos">41</span>        <span class="k">if</span> <span class="p">(</span><span class="n">result_row_idx</span> <span class="o">&lt;</span> <span class="n">X_n_rows</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span>
<span class="linenos">42</span>            <span class="p">(</span><span class="n">local_col_idx</span> <span class="o">+</span> <span class="p">(</span><span class="n">square_block_side</span> <span class="o">*</span> <span class="n">block_idx</span><span class="p">))</span> <span class="o">&lt;</span> <span class="n">n_cols</span>
<span class="linenos">43</span>        <span class="p">):</span>
<span class="linenos">44</span>            <span class="n">X_slm</span><span class="p">[</span><span class="n">local_row_idx</span><span class="p">,</span> <span class="n">local_col_idx</span><span class="p">]</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span>
<span class="linenos">45</span>                <span class="n">result_row_idx</span><span class="p">,</span> <span class="n">local_col_idx</span> <span class="o">+</span> <span class="p">(</span><span class="n">square_block_side</span> <span class="o">*</span> <span class="n">block_idx</span><span class="p">)</span>
<span class="linenos">46</span>            <span class="p">]</span>
<span class="linenos">47</span>
<span class="linenos">48</span>        <span class="k">if</span> <span class="p">(</span><span class="n">result_col_idx</span> <span class="o">&lt;</span> <span class="n">Y_n_cols</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span>
<span class="linenos">49</span>            <span class="p">(</span><span class="n">local_row_idx</span> <span class="o">+</span> <span class="p">(</span><span class="n">square_block_side</span> <span class="o">*</span> <span class="n">block_idx</span><span class="p">))</span> <span class="o">&lt;</span> <span class="n">n_cols</span>
<span class="linenos">50</span>        <span class="p">):</span>
<span class="linenos">51</span>            <span class="n">Y_slm</span><span class="p">[</span><span class="n">local_row_idx</span><span class="p">,</span> <span class="n">local_col_idx</span><span class="p">]</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span>
<span class="linenos">52</span>                <span class="n">local_row_idx</span> <span class="o">+</span> <span class="p">(</span><span class="n">square_block_side</span> <span class="o">*</span> <span class="n">block_idx</span><span class="p">),</span> <span class="n">result_col_idx</span>
<span class="linenos">53</span>            <span class="p">]</span>
<span class="linenos">54</span>
<span class="linenos">55</span>        <span class="n">kapi</span><span class="o">.</span><span class="n">group_barrier</span><span class="p">(</span><span class="n">gr</span><span class="p">)</span>
<span class="linenos">56</span>
<span class="linenos">57</span>        <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">square_block_side</span><span class="p">):</span>
<span class="linenos">58</span>            <span class="n">output</span> <span class="o">+=</span> <span class="n">X_slm</span><span class="p">[</span><span class="n">local_row_idx</span><span class="p">,</span> <span class="n">idx</span><span class="p">]</span> <span class="o">*</span> <span class="n">Y_slm</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span> <span class="n">local_col_idx</span><span class="p">]</span>
<span class="linenos">59</span>
<span class="linenos">60</span>        <span class="n">kapi</span><span class="o">.</span><span class="n">group_barrier</span><span class="p">(</span><span class="n">gr</span><span class="p">)</span>
<span class="linenos">61</span>
<span class="linenos">62</span>    <span class="k">if</span> <span class="p">(</span><span class="n">result_row_idx</span> <span class="o">&lt;</span> <span class="n">X_n_rows</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">result_col_idx</span> <span class="o">&lt;</span> <span class="n">Y_n_cols</span><span class="p">):</span>
<span class="linenos">63</span>        <span class="n">result</span><span class="p">[</span><span class="n">result_row_idx</span><span class="p">,</span> <span class="n">result_col_idx</span><span class="p">]</span> <span class="o">=</span> <span class="n">output</span>
<span class="linenos">64</span>
<span class="linenos">65</span>
<span class="linenos">66</span><span class="k">def</span> <span class="nf">_arange_reshaped</span><span class="p">(</span><span class="n">shape</span><span class="p">,</span> <span class="n">dtype</span><span class="p">):</span>
<span class="linenos">67</span>    <span class="n">n_items</span> <span class="o">=</span> <span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="linenos">68</span>    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">n_items</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">shape</span><span class="p">)</span>
<span class="linenos">69</span>
<span class="linenos">70</span>
<span class="linenos">71</span><span class="n">X</span> <span class="o">=</span> <span class="n">_arange_reshaped</span><span class="p">((</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">dtype</span><span class="p">)</span>
<span class="linenos">72</span><span class="n">Y</span> <span class="o">=</span> <span class="n">_arange_reshaped</span><span class="p">((</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">dtype</span><span class="p">)</span>
<span class="linenos">73</span><span class="n">X</span> <span class="o">=</span> <span class="n">dpt</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="linenos">74</span><span class="n">Y</span> <span class="o">=</span> <span class="n">dpt</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">Y</span><span class="p">)</span>
<span class="linenos">75</span><span class="n">device</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">device</span><span class="o">.</span><span class="n">sycl_device</span>
<span class="linenos">76</span><span class="n">result</span> <span class="o">=</span> <span class="n">dpt</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">dtype</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="n">device</span><span class="p">)</span>
<span class="linenos">77</span><span class="n">X_slm</span> <span class="o">=</span> <span class="n">kapi</span><span class="o">.</span><span class="n">LocalAccessor</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="n">work_group_size</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>
<span class="linenos">78</span><span class="n">Y_slm</span> <span class="o">=</span> <span class="n">kapi</span><span class="o">.</span><span class="n">LocalAccessor</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="n">work_group_size</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>
<span class="linenos">79</span>
<span class="linenos">80</span><span class="n">dpex</span><span class="o">.</span><span class="n">call_kernel</span><span class="p">(</span><span class="n">matmul</span><span class="p">,</span> <span class="n">kapi</span><span class="o">.</span><span class="n">NdRange</span><span class="p">((</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)),</span> <span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">X_slm</span><span class="p">,</span> <span class="n">Y_slm</span><span class="p">,</span> <span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>When writing an nd-range kernel, a programmer defines a set of groups of
work-items instead of a flat execution range.There are several semantic rules
associated both with a work-group and the work-items in a work-group:</p>
<ul class="simple">
<li><p>Each work-group gets executed in an arbitrary order by the underlying
runtime and programmers should not assume any implicit ordering.</p></li>
<li><p>Work-items in different wok-groups cannot communicate with each other except
via atomic operations on global memory.</p></li>
<li><p>Work-items within a work-group share a common memory region called
“shared local memory” (SLM). Depending on the device the SLM maybe mapped to a
dedicated fast memory.</p></li>
<li><p>Work-items in a work-group can synchronize using a
<a class="reference internal" href="../../autoapi/numba_dpex/kernel_api/index.html#numba_dpex.kernel_api.group_barrier" title="numba_dpex.kernel_api.group_barrier"><code class="xref py py-func docutils literal notranslate"><span class="pre">numba_dpex.kernel_api.group_barrier()</span></code></a> operation that can additionally
guarantee memory consistency using a <em>work-group memory fence</em>.</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The SYCL language provides additional features for work-items in a
work-group such as <em>group functions</em> that specify communication routines
across work-items and also implement patterns such as reduction and scan.
These features are not yet available in numba-dpex.</p>
</div>
<p>An nd-range kernel needs to be launched with an instance of the
<a class="reference internal" href="../../autoapi/numba_dpex/kernel_api/index.html#numba_dpex.kernel_api.NdRange" title="numba_dpex.kernel_api.NdRange"><code class="xref py py-class docutils literal notranslate"><span class="pre">numba_dpex.kernel_api.NdRange</span></code></a> class and the first
argument to an nd-range kernel has to be an instance of
<a class="reference internal" href="../../autoapi/numba_dpex/kernel_api/index.html#numba_dpex.kernel_api.NdItem" title="numba_dpex.kernel_api.NdItem"><code class="xref py py-class docutils literal notranslate"><span class="pre">numba_dpex.kernel_api.NdItem</span></code></a>. Apart from the need to provide an
<code class="docutils literal notranslate"><span class="pre">`NdItem</span></code> parameter, the rest of the semantic rules that apply to a range
kernel also apply to an nd-range kernel.</p>
</section>
<section id="launching-a-kernel">
<span id="id2"></span><h3>Launching a kernel<a class="headerlink" href="#launching-a-kernel" title="Link to this heading">#</a></h3>
<p>A <code class="docutils literal notranslate"><span class="pre">kernel</span></code> decorated kapi function produces a <code class="docutils literal notranslate"><span class="pre">KernelDispatcher</span></code> object that
is a type of a Numba* <a class="reference external" href="https://numba.readthedocs.io/en/stable/reference/jit-compilation.html#dispatcher-objects">Dispatcher</a> object. However, unlike regular Numba*
Dispatcher objects a <code class="docutils literal notranslate"><span class="pre">KernelDispatcher</span></code> object cannot be directly invoked from
either CPython or another compiled Numba* <code class="docutils literal notranslate"><span class="pre">jit</span></code> function. To invoke a
<code class="docutils literal notranslate"><span class="pre">kernel</span></code> decorated function, a programmer has to use the
<a class="reference internal" href="../../autoapi/numba_dpex/core/kernel_launcher/index.html#numba_dpex.core.kernel_launcher.call_kernel" title="numba_dpex.core.kernel_launcher.call_kernel"><code class="xref py py-func docutils literal notranslate"><span class="pre">numba_dpex.core.kernel_launcher.call_kernel()</span></code></a> function.</p>
<p>To invoke a <code class="docutils literal notranslate"><span class="pre">KernelDispatcher</span></code> the <code class="docutils literal notranslate"><span class="pre">call_kernel</span></code> function requires three
things: the <code class="docutils literal notranslate"><span class="pre">KernelDispatcher</span></code> object, the <code class="docutils literal notranslate"><span class="pre">Range</span></code> or <code class="docutils literal notranslate"><span class="pre">NdRange</span></code> object
over which the kernel is to be executed, and the list of arguments to be passed
to the compiled kernel. Once called with the necessary  arguments, the
<code class="docutils literal notranslate"><span class="pre">call_kernel</span></code> function does the following main things:</p>
<ul class="simple">
<li><p>Compiles the <code class="docutils literal notranslate"><span class="pre">KernelDispatcher</span></code> object specializing it for the provided
argument types.</p></li>
<li><dl class="simple">
<dt><a class="reference external" href="https://numba.readthedocs.io/en/stable/extending/interval-example.html#boxing-and-unboxing">Unboxes</a>  the kernel arguments by converting CPython objects into Numba* or</dt><dd><p>numba-dpex objects.</p>
</dd>
</dl>
</li>
<li><p>Infer the execution queue on which to submit the kernel from the provided
kernel arguments. (TODO: Refer compute follows data.)</p></li>
<li><p>Submits the kernel to the execution queue.</p></li>
<li><p>Waits for the execution completion, before returning control back to the
caller.</p></li>
</ul>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>Programmers should note the following two things when defining the global or
local range to launch a kernel.</p>
<ul>
<li><p>Numba-dpex currently limits the maximum allowed global range size to
<code class="docutils literal notranslate"><span class="pre">2^31-1</span></code>. It is due to the capabilities of current OpenCL GPU backends
that generally do not support more than 32-bit global range sizes. A
kernel requesting a larger global range than that will not execute and a
<code class="docutils literal notranslate"><span class="pre">dpctl._sycl_queue.SyclKernelSubmitError</span></code> will get raised.</p>
<p>The Intel dpcpp SYCL compiler does handle greater than 32-bit global
ranges for GPU backends by wrapping the kernel in a new kernel that has
each work-item perform multiple invocations of the original kernel in a
32-bit global range. Such a feature is not yet available in numba-dpex.</p>
</li>
<li><p>When launching an nd-range kernel, if the number of work-items for a
particular dimension of a work-group exceeds the maximum device
capability, it can result in undefined behavior.</p></li>
</ul>
<p>The maximum allowed work-items for a device can be queried programmatically
as shown in <a class="reference internal" href="#ex-max-work-item"><span class="std std-ref">Example: Query maximum number of work-items for a device</span></a>.</p>
<div class="literal-block-wrapper docutils container" id="ex-max-work-item">
<div class="code-block-caption"><span class="caption-text"><strong>Example:</strong> Query maximum number of work-items for a device</span><a class="headerlink" href="#ex-max-work-item" title="Link to this code">#</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="kn">import</span> <span class="nn">dpctl</span>
<span class="linenos"> 2</span><span class="kn">import</span> <span class="nn">math</span>
<span class="linenos"> 3</span>
<span class="linenos"> 4</span><span class="n">d</span> <span class="o">=</span> <span class="n">dpctl</span><span class="o">.</span><span class="n">SyclDevice</span><span class="p">(</span><span class="s2">&quot;gpu&quot;</span><span class="p">)</span>
<span class="linenos"> 5</span><span class="n">d</span><span class="o">.</span><span class="n">print_device_info</span><span class="p">()</span>
<span class="linenos"> 6</span>
<span class="linenos"> 7</span><span class="n">max_num_work_items</span> <span class="o">=</span> <span class="p">(</span>
<span class="linenos"> 8</span>    <span class="n">d</span><span class="o">.</span><span class="n">max_work_group_size</span>
<span class="linenos"> 9</span>    <span class="o">*</span> <span class="n">d</span><span class="o">.</span><span class="n">max_work_item_sizes1d</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="linenos">10</span>    <span class="o">*</span> <span class="n">d</span><span class="o">.</span><span class="n">max_work_item_sizes2d</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="linenos">11</span>    <span class="o">*</span> <span class="n">d</span><span class="o">.</span><span class="n">max_work_item_sizes3d</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="linenos">12</span><span class="p">)</span>
<span class="linenos">13</span><span class="nb">print</span><span class="p">(</span><span class="n">max_num_work_items</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;(2^</span><span class="si">{</span><span class="nb">int</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">max_num_work_items</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">))</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
<span class="linenos">14</span>
<span class="linenos">15</span><span class="n">cpud</span> <span class="o">=</span> <span class="n">dpctl</span><span class="o">.</span><span class="n">SyclDevice</span><span class="p">(</span><span class="s2">&quot;cpu&quot;</span><span class="p">)</span>
<span class="linenos">16</span><span class="n">cpud</span><span class="o">.</span><span class="n">print_device_info</span><span class="p">()</span>
<span class="linenos">17</span>
<span class="linenos">18</span><span class="n">max_num_work_items_cpu</span> <span class="o">=</span> <span class="p">(</span>
<span class="linenos">19</span>    <span class="n">cpud</span><span class="o">.</span><span class="n">max_work_group_size</span>
<span class="linenos">20</span>    <span class="o">*</span> <span class="n">cpud</span><span class="o">.</span><span class="n">max_work_item_sizes1d</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="linenos">21</span>    <span class="o">*</span> <span class="n">cpud</span><span class="o">.</span><span class="n">max_work_item_sizes2d</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="linenos">22</span>    <span class="o">*</span> <span class="n">cpud</span><span class="o">.</span><span class="n">max_work_item_sizes3d</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="linenos">23</span><span class="p">)</span>
<span class="linenos">24</span><span class="nb">print</span><span class="p">(</span><span class="n">max_num_work_items_cpu</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;(2^</span><span class="si">{</span><span class="nb">int</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">max_num_work_items_cpu</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">))</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>The output for <a class="reference internal" href="#ex-max-work-item"><span class="std std-ref">Example: Query maximum number of work-items for a device</span></a> on a system with an Intel Gen9 integrated
graphics processor and a 9th Generation Coffee Lake CPU is shown in
<a class="reference internal" href="#ex-max-work-item-output"><span class="std std-ref">OUTPUT: Query maximum number of work-items for a device</span></a>.</p>
<div class="literal-block-wrapper docutils container" id="ex-max-work-item-output">
<div class="code-block-caption"><span class="caption-text"><strong>OUTPUT:</strong> Query maximum number of work-items for a device</span><a class="headerlink" href="#ex-max-work-item-output" title="Link to this code">#</a></div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="w">    </span>Name<span class="w">            </span>Intel<span class="o">(</span>R<span class="o">)</span><span class="w"> </span>UHD<span class="w"> </span>Graphics<span class="w"> </span><span class="m">630</span><span class="w"> </span><span class="o">[</span>0x3e98<span class="o">]</span>
<span class="w">    </span>Driver<span class="w"> </span>version<span class="w">  </span><span class="m">1</span>.3.24595
<span class="w">    </span>Vendor<span class="w">          </span>Intel<span class="o">(</span>R<span class="o">)</span><span class="w"> </span>Corporation
<span class="w">    </span>Filter<span class="w"> </span>string<span class="w">   </span>level_zero:gpu:0

<span class="m">4294967296</span><span class="w"> </span><span class="o">(</span><span class="m">2</span>^32<span class="o">)</span>
<span class="w">    </span>Name<span class="w">            </span>Intel<span class="o">(</span>R<span class="o">)</span><span class="w"> </span>Core<span class="o">(</span>TM<span class="o">)</span><span class="w"> </span>i7-9700<span class="w"> </span>CPU<span class="w"> </span>@<span class="w"> </span><span class="m">3</span>.00GHz
<span class="w">    </span>Driver<span class="w"> </span>version<span class="w">  </span><span class="m">2023</span>.16.12.0.12_195853.xmain-hotfix
<span class="w">    </span>Vendor<span class="w">          </span>Intel<span class="o">(</span>R<span class="o">)</span><span class="w"> </span>Corporation
<span class="w">    </span>Filter<span class="w"> </span>string<span class="w">   </span>opencl:cpu:0

<span class="m">4503599627370496</span><span class="w"> </span><span class="o">(</span><span class="m">2</span>^52<span class="o">)</span>
</pre></div>
</div>
</div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">call_kernel</span></code> function can be invoked both from CPython and from another
Numba* compiled function. Note that the <code class="docutils literal notranslate"><span class="pre">call_kernel</span></code> function supports only
synchronous execution of kernel and the <code class="docutils literal notranslate"><span class="pre">call_kernel_async</span></code> function should be
used for asynchronous mode of kernel execution (refer
<a class="reference internal" href="#launching-an-async-kernel"><span class="std std-ref">Async kernel execution</span></a>).</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>Refer the API documentation for
<a class="reference internal" href="../../autoapi/numba_dpex/core/kernel_launcher/index.html#numba_dpex.core.kernel_launcher.call_kernel" title="numba_dpex.core.kernel_launcher.call_kernel"><code class="xref py py-func docutils literal notranslate"><span class="pre">numba_dpex.core.kernel_launcher.call_kernel()</span></code></a> for more details.</p>
</div>
</section>
<section id="the-device-func-decorator">
<h3>The <code class="docutils literal notranslate"><span class="pre">device_func</span></code> decorator<a class="headerlink" href="#the-device-func-decorator" title="Link to this heading">#</a></h3>
<p>Numba-dpex provides a decorator to express auxiliary device-only functions that
can be called from a kernel or another device function, but are not callable
from the host. This decorator <a class="reference internal" href="../../autoapi/numba_dpex/core/decorators/index.html#numba_dpex.core.decorators.device_func" title="numba_dpex.core.decorators.device_func"><code class="xref py py-func docutils literal notranslate"><span class="pre">numba_dpex.core.decorators.device_func()</span></code></a> has
no direct analogue in SYCL and primarily is provided to help programmers make
their kapi applications modular. <a class="reference internal" href="#ex-device-func1"><span class="std std-ref">Example: Basic usage of device_func</span></a> shows a simple usage of
the <code class="docutils literal notranslate"><span class="pre">device_func</span></code> decorator.</p>
<div class="literal-block-wrapper docutils container" id="ex-device-func1">
<div class="code-block-caption"><span class="caption-text"><strong>Example:</strong> Basic usage of device_func</span><a class="headerlink" href="#ex-device-func1" title="Link to this code">#</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="kn">import</span> <span class="nn">dpnp</span>
<span class="linenos"> 2</span>
<span class="linenos"> 3</span><span class="kn">import</span> <span class="nn">numba_dpex</span> <span class="k">as</span> <span class="nn">dpex</span>
<span class="linenos"> 4</span><span class="kn">from</span> <span class="nn">numba_dpex</span> <span class="kn">import</span> <span class="n">kernel_api</span> <span class="k">as</span> <span class="n">kapi</span>
<span class="linenos"> 5</span>
<span class="linenos"> 6</span><span class="c1"># Array size</span>
<span class="linenos"> 7</span><span class="n">N</span> <span class="o">=</span> <span class="mi">10</span>
<span class="linenos"> 8</span>
<span class="linenos"> 9</span>
<span class="linenos">10</span><span class="nd">@dpex</span><span class="o">.</span><span class="n">device_func</span>
<span class="linenos">11</span><span class="k">def</span> <span class="nf">a_device_function</span><span class="p">(</span><span class="n">a</span><span class="p">):</span>
<span class="linenos">12</span><span class="w">    </span><span class="sd">&quot;&quot;&quot;A device callable function that can be invoked from a kernel or</span>
<span class="linenos">13</span><span class="sd">    another device function.</span>
<span class="linenos">14</span><span class="sd">    &quot;&quot;&quot;</span>
<span class="linenos">15</span>    <span class="k">return</span> <span class="n">a</span> <span class="o">+</span> <span class="mi">1</span>
<span class="linenos">16</span>
<span class="linenos">17</span>
<span class="linenos">18</span><span class="nd">@dpex</span><span class="o">.</span><span class="n">kernel</span>
<span class="linenos">19</span><span class="k">def</span> <span class="nf">a_kernel_function</span><span class="p">(</span><span class="n">item</span><span class="p">:</span> <span class="n">kapi</span><span class="o">.</span><span class="n">Item</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
<span class="linenos">20</span><span class="w">    </span><span class="sd">&quot;&quot;&quot;Demonstrates calling a device function from a kernel.&quot;&quot;&quot;</span>
<span class="linenos">21</span>    <span class="n">i</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="n">get_id</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="linenos">22</span>    <span class="n">b</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">a_device_function</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
<span class="linenos">23</span>
<span class="linenos">24</span>
<span class="linenos">25</span><span class="n">N</span> <span class="o">=</span> <span class="mi">16</span>
<span class="linenos">26</span><span class="n">a</span> <span class="o">=</span> <span class="n">dpnp</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dpnp</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
<span class="linenos">27</span><span class="n">b</span> <span class="o">=</span> <span class="n">dpnp</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dpnp</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
<span class="linenos">28</span>
<span class="linenos">29</span><span class="n">dpex</span><span class="o">.</span><span class="n">call_kernel</span><span class="p">(</span><span class="n">a_kernel_function</span><span class="p">,</span> <span class="n">dpex</span><span class="o">.</span><span class="n">Range</span><span class="p">(</span><span class="n">N</span><span class="p">),</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="ex-device-func2">
<div class="code-block-caption"><span class="caption-text"><strong>Example:</strong> Using kapi functionalities in a device_func</span><a class="headerlink" href="#ex-device-func2" title="Link to this code">#</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="kn">import</span> <span class="nn">dpnp</span>
<span class="linenos"> 2</span>
<span class="linenos"> 3</span><span class="kn">import</span> <span class="nn">numba_dpex</span> <span class="k">as</span> <span class="nn">dpex</span>
<span class="linenos"> 4</span><span class="kn">from</span> <span class="nn">numba_dpex</span> <span class="kn">import</span> <span class="n">kernel_api</span> <span class="k">as</span> <span class="n">kapi</span>
<span class="linenos"> 5</span>
<span class="linenos"> 6</span>
<span class="linenos"> 7</span><span class="nd">@dpex</span><span class="o">.</span><span class="n">device_func</span>
<span class="linenos"> 8</span><span class="k">def</span> <span class="nf">increment_value</span><span class="p">(</span><span class="n">nd_item</span><span class="p">:</span> <span class="n">kapi</span><span class="o">.</span><span class="n">NdItem</span><span class="p">,</span> <span class="n">a</span><span class="p">):</span>
<span class="linenos"> 9</span><span class="w">    </span><span class="sd">&quot;&quot;&quot;Demonstrates the usage of group_barrier and NdItem usage in a</span>
<span class="linenos">10</span><span class="sd">    device_func.</span>
<span class="linenos">11</span><span class="sd">    &quot;&quot;&quot;</span>
<span class="linenos">12</span>    <span class="n">i</span> <span class="o">=</span> <span class="n">nd_item</span><span class="o">.</span><span class="n">get_global_id</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="linenos">13</span>
<span class="linenos">14</span>    <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
<span class="linenos">15</span>    <span class="n">kapi</span><span class="o">.</span><span class="n">group_barrier</span><span class="p">(</span><span class="n">nd_item</span><span class="o">.</span><span class="n">get_group</span><span class="p">(),</span> <span class="n">kapi</span><span class="o">.</span><span class="n">MemoryScope</span><span class="o">.</span><span class="n">DEVICE</span><span class="p">)</span>
<span class="linenos">16</span>
<span class="linenos">17</span>    <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<span class="linenos">18</span>        <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">a</span><span class="o">.</span><span class="n">size</span><span class="p">):</span>
<span class="linenos">19</span>            <span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+=</span> <span class="n">a</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
<span class="linenos">20</span>
<span class="linenos">21</span>
<span class="linenos">22</span><span class="nd">@dpex</span><span class="o">.</span><span class="n">kernel</span>
<span class="linenos">23</span><span class="k">def</span> <span class="nf">another_kernel</span><span class="p">(</span><span class="n">nd_item</span><span class="p">:</span> <span class="n">kapi</span><span class="o">.</span><span class="n">NdItem</span><span class="p">,</span> <span class="n">a</span><span class="p">):</span>
<span class="linenos">24</span><span class="w">    </span><span class="sd">&quot;&quot;&quot;The kernel does everything by calling a device_func.&quot;&quot;&quot;</span>
<span class="linenos">25</span>    <span class="n">increment_value</span><span class="p">(</span><span class="n">nd_item</span><span class="p">,</span> <span class="n">a</span><span class="p">)</span>
<span class="linenos">26</span>
<span class="linenos">27</span>
<span class="linenos">28</span><span class="n">N</span> <span class="o">=</span> <span class="mi">16</span>
<span class="linenos">29</span><span class="n">b</span> <span class="o">=</span> <span class="n">dpnp</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dpnp</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
<span class="linenos">30</span>
<span class="linenos">31</span><span class="n">dpex</span><span class="o">.</span><span class="n">call_kernel</span><span class="p">(</span><span class="n">another_kernel</span><span class="p">,</span> <span class="n">dpex</span><span class="o">.</span><span class="n">NdRange</span><span class="p">((</span><span class="n">N</span><span class="p">,),</span> <span class="p">(</span><span class="n">N</span><span class="p">,)),</span> <span class="n">b</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>A device function does not require the first argument to be an index space id
class, and unlike a kernel function a device function is allowed to return a
value. All kapi functionality can be used in a <code class="docutils literal notranslate"><span class="pre">device_func</span></code> decorated
function and at compilation stage numba-dpex will attempt to inline a
<code class="docutils literal notranslate"><span class="pre">device_func</span></code> into the kernel where it is used.</p>
</section>
<section id="supported-types-of-kernel-argument">
<h3>Supported types of kernel argument<a class="headerlink" href="#supported-types-of-kernel-argument" title="Link to this heading">#</a></h3>
<p>A kapi kernel function can have both array and scalar arguments. At least one of
the argument to every kernel function has to be an array. The requirement is
enforced so that a execution queue can be inferred at the kernel launch stage.
An array type argument is passed as a reference to the kernel and all scalar
arguments are passed by value.</p>
<section id="supported-array-types">
<h4>Supported array types<a class="headerlink" href="#supported-array-types" title="Link to this heading">#</a></h4>
<ul class="simple">
<li><p><a class="reference external" href="https://intelpython.github.io/dpctl/latest/docfiles/dpctl/usm_ndarray.html#dpctl.tensor.usm_ndarray">dpctl.tensor.usm_ndarray</a> : A SYCL-based Python Array API complaint tensor.</p></li>
<li><p><a class="reference external" href="https://intelpython.github.io/dpnp/reference/ndarray.html">dpnp.ndarray</a> :  A <code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>-like array container that supports SYCL USM memory allocation.</p></li>
</ul>
</section>
<section id="scalar-types">
<h4>Scalar types<a class="headerlink" href="#scalar-types" title="Link to this heading">#</a></h4>
<p>Scalar values can be passed to a kernel function either using the default Python
scalar type or as explicit NumPy or dpnp data type objects.
<a class="reference internal" href="#ex-scalar-kernel-arg-ty"><span class="std std-ref">Example: Ways of defining a scalar kernel argument</span></a> shows the two possible ways of defining a scalar
type. In both scenarios, numba-dpex depends on the default Numba* type inferring
algorithm to determine the LLVM IR type of a Python object that represents a
scalar value. At the kernel submission stage the LLVM IR type is reinterpreted
as a C++11 type to interoperate with the underlying SYCL runtime.</p>
<div class="literal-block-wrapper docutils container" id="ex-scalar-kernel-arg-ty">
<div class="code-block-caption"><span class="caption-text"><strong>Example:</strong> Ways of defining a scalar kernel argument</span><a class="headerlink" href="#ex-scalar-kernel-arg-ty" title="Link to this code">#</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">dpnp</span>

<span class="n">a</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">dpnp</span><span class="o">.</span><span class="n">dtype</span><span class="p">(</span><span class="s2">&quot;int32&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">type</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">a</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">b</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="ex-scalar-kernel-arg-ty-output">
<div class="code-block-caption"><span class="caption-text"><strong>Output:</strong> Ways of defining a scalar kernel argument</span><a class="headerlink" href="#ex-scalar-kernel-arg-ty-output" title="Link to this code">#</a></div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>&lt;class<span class="w"> </span><span class="s1">&#39;int&#39;</span>&gt;
&lt;class<span class="w"> </span><span class="s1">&#39;numpy.int32&#39;</span>&gt;
</pre></div>
</div>
</div>
<p>The following scalar types are currently supported as arguments of a numba-dpex
kernel function:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">int</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">float</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">complex</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">numpy.int32</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">numpy.uint32</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">numpy.int64</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">numpy.uint32</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">numpy.float32</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">numpy.float64</span></code></p></li>
</ul>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>The Numba* type inferring algorithm by default infers a native Python
scalar type to be a 64-bit value. The algorithm is defined that way to be
consistent with the default CPython behavior. The default inferred 64-bit
type can cause compilation failures on platforms that do not have native
64-bit floating point support. Another potential fallout of the default
64-bit type inference can be when a narrower width type is required by a
specific kernel. To avoid these issues, users are advised to always use a
dpnp/numpy type object to explicitly define the type of a scalar value.</p>
</div>
</section>
<section id="dlpack-support">
<h4>DLPack support<a class="headerlink" href="#dlpack-support" title="Link to this heading">#</a></h4>
<p>At this time direct support for the <a class="reference external" href="https://dmlc.github.io/dlpack/latest/">DLPack</a> protocol is has not been added to
numba-dpex. To interoperate numba_dpex with other SYCL USM based libraries,
users should first convert their input tensor or ndarray object into either of
the two supported array types, both of which support DLPack.</p>
</section>
</section>
</section>
<section id="supported-python-features">
<h2>Supported Python features<a class="headerlink" href="#supported-python-features" title="Link to this heading">#</a></h2>
<section id="mathematical-operations">
<h3>Mathematical operations<a class="headerlink" href="#mathematical-operations" title="Link to this heading">#</a></h3>
<p>Scalar mathematical functions from the Python <a class="reference external" href="https://docs.python.org/3/library/math.html">math</a> module and the <a class="reference external" href="https://intelpython.github.io/dpnp/">dpnp</a>
library can be used inside a kernel function. During compilation the
mathematical functions get compiled into device-specific intrinsic instructions.</p>
<div class="table-wrapper colwidths-given docutils container" id="id3">
<table class="docutils align-default" id="id3">
<caption><span class="caption-text">Current support matrix of <code class="docutils literal notranslate"><span class="pre">math</span></code> module functions</span><a class="headerlink" href="#id3" title="Link to this table">#</a></caption>
<colgroup>
<col style="width: 30.0%" />
<col style="width: 70.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head"><p>Supported signature</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">math.isnan</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">types.float32(types.float32)</span></code>; <code class="docutils literal notranslate"><span class="pre">types.float64(types.float64)</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">math.isinf</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">types.float32(types.float32)</span></code>; <code class="docutils literal notranslate"><span class="pre">types.float64(types.float64)</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">math.ceil</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">types.float32(types.float32)</span></code>; <code class="docutils literal notranslate"><span class="pre">types.float64(types.float64)</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">math.floor</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">types.float32(types.float32)</span></code>; <code class="docutils literal notranslate"><span class="pre">types.float64(types.float64)</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">math.trunc</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">types.float32(types.float32)</span></code>; <code class="docutils literal notranslate"><span class="pre">types.float64(types.float64)</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">math.fabs</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">types.float32(types.float32)</span></code>; <code class="docutils literal notranslate"><span class="pre">types.float64(types.float64)</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">math.sqrt</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">types.float32(types.float32)</span></code>; <code class="docutils literal notranslate"><span class="pre">types.float64(types.float64)</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">math.exp</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">types.float32(types.float32)</span></code>; <code class="docutils literal notranslate"><span class="pre">types.float64(types.float64)</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">math.expm1</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">types.float32(types.float32)</span></code>; <code class="docutils literal notranslate"><span class="pre">types.float64(types.float64)</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">math.log</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">types.float32(types.float32)</span></code>; <code class="docutils literal notranslate"><span class="pre">types.float64(types.float64)</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">math.log10</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">types.float32(types.float32)</span></code>; <code class="docutils literal notranslate"><span class="pre">types.float64(types.float64)</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">math.log1p</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">types.float32(types.float32)</span></code>; <code class="docutils literal notranslate"><span class="pre">types.float64(types.float64)</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">math.sin</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">types.float32(types.float32)</span></code>; <code class="docutils literal notranslate"><span class="pre">types.float64(types.float64)</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">math.cos</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">types.float32(types.float32)</span></code>; <code class="docutils literal notranslate"><span class="pre">types.float64(types.float64)</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">math.tan</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">types.float32(types.float32)</span></code>; <code class="docutils literal notranslate"><span class="pre">types.float64(types.float64)</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">math.asin</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">types.float32(types.float32)</span></code>; <code class="docutils literal notranslate"><span class="pre">types.float64(types.float64)</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">math.acos</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">types.float32(types.float32)</span></code>; <code class="docutils literal notranslate"><span class="pre">types.float64(types.float64)</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">math.atan</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">types.float32(types.float32)</span></code>; <code class="docutils literal notranslate"><span class="pre">types.float64(types.float64)</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">math.sinh</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">types.float32(types.float32)</span></code>; <code class="docutils literal notranslate"><span class="pre">types.float64(types.float64)</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">math.cosh</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">types.float32(types.float32)</span></code>; <code class="docutils literal notranslate"><span class="pre">types.float64(types.float64)</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">math.tanh</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">types.float32(types.float32)</span></code>; <code class="docutils literal notranslate"><span class="pre">types.float64(types.float64)</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">math.asinh</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">types.float32(types.float32)</span></code>; <code class="docutils literal notranslate"><span class="pre">types.float64(types.float64)</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">math.acosh</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">types.float32(types.float32)</span></code>; <code class="docutils literal notranslate"><span class="pre">types.float64(types.float64)</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">math.atanh</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">types.float32(types.float32)</span></code>; <code class="docutils literal notranslate"><span class="pre">types.float64(types.float64)</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">math.exp2</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">types.float32(types.float32)</span></code>; <code class="docutils literal notranslate"><span class="pre">types.float64(types.float64)</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">math.log2</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">types.float32(types.float32)</span></code>; <code class="docutils literal notranslate"><span class="pre">types.float64(types.float64)</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">math.erf</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">types.float32(types.float32)</span></code>; <code class="docutils literal notranslate"><span class="pre">types.float64(types.float64)</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">math.erfc</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">types.float32(types.float32)</span></code>; <code class="docutils literal notranslate"><span class="pre">types.float64(types.float64)</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">math.gamma</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">types.float32(types.float32)</span></code>; <code class="docutils literal notranslate"><span class="pre">types.float64(types.float64)</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">math.lgamma</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">types.float32(types.float32)</span></code>; <code class="docutils literal notranslate"><span class="pre">types.float64(types.float64)</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">math.copysign</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">types.float32(types.float32,</span> <span class="pre">types.float32)</span></code>; <code class="docutils literal notranslate"><span class="pre">types.float64(types.float64,</span> <span class="pre">types.float64)</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">math.atan2</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">types.float32(types.float32,</span> <span class="pre">types.float32)</span></code>; <code class="docutils literal notranslate"><span class="pre">types.float64(types.float64,</span> <span class="pre">types.float64)</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">math.pow</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">types.float32(types.float32,</span> <span class="pre">types.float32)</span></code>; <code class="docutils literal notranslate"><span class="pre">types.float64(types.float64,</span> <span class="pre">types.float64)</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">math.fmod</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">types.float32(types.float32,</span> <span class="pre">types.float32)</span></code>; <code class="docutils literal notranslate"><span class="pre">types.float64(types.float64,</span> <span class="pre">types.float64)</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">math.ldexp</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">types.float32(types.float32,</span> <span class="pre">types.int32)</span></code>;
<code class="docutils literal notranslate"><span class="pre">types.float32(types.float32,</span> <span class="pre">types.int64)</span></code>;
<code class="docutils literal notranslate"><span class="pre">types.float64(types.float64,</span> <span class="pre">types.int32)</span></code>;
<code class="docutils literal notranslate"><span class="pre">types.float64(types.float64,</span> <span class="pre">types.int64)</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">math.hypot</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">types.float32(types.float32,</span> <span class="pre">types.int32)</span></code>;
<code class="docutils literal notranslate"><span class="pre">types.float32(types.float32,</span> <span class="pre">types.int64)</span></code>;
<code class="docutils literal notranslate"><span class="pre">types.float64(types.float64,</span> <span class="pre">types.int32)</span></code>;
<code class="docutils literal notranslate"><span class="pre">types.float64(types.float64,</span> <span class="pre">types.int64)</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">math.frexp</span></code></p></td>
<td><p>Not supported</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">math.ldexp</span></code></p></td>
<td><p>Not supported</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">math.trunc</span></code></p></td>
<td><p>Not supported</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">math.modf</span></code></p></td>
<td><p>Not supported</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">math.factorial</span></code></p></td>
<td><p>Not supported</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">math.fsum</span></code></p></td>
<td><p>Not supported</p></td>
</tr>
</tbody>
</table>
</div>
<div class="admonition caution">
<p class="admonition-title">Caution</p>
<p>The supported signature for some of the <code class="docutils literal notranslate"><span class="pre">math</span></code> module functions in the
compiled mode differs from CPython. The divergence in behavior is a known
issue. Please refer <a class="reference external" href="https://github.com/IntelPython/numba-dpex/issues/759">https://github.com/IntelPython/numba-dpex/issues/759</a> for
updates.</p>
</div>
<div class="table-wrapper colwidths-auto docutils container" id="id4">
<table class="docutils align-default" id="id4">
<caption><span class="caption-text">Current support matrix of <code class="docutils literal notranslate"><span class="pre">dpnp</span></code> functions</span><a class="headerlink" href="#id4" title="Link to this table">#</a></caption>
<thead>
<tr class="row-odd"><th class="head"></th>
<th class="head"></th>
<th class="head"></th>
<th class="head"></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Name</p></td>
<td><p>Supported types</p></td>
<td><p>Notes</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">dpnp.add</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">types.float32</span></code> <code class="docutils literal notranslate"><span class="pre">types.float64</span></code> <code class="docutils literal notranslate"><span class="pre">types.int32</span></code> <code class="docutils literal notranslate"><span class="pre">types.int64</span></code></p></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">dpnp.arctan2</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">types.float32</span></code> <code class="docutils literal notranslate"><span class="pre">types.float64</span></code> <code class="docutils literal notranslate"><span class="pre">types.int32</span></code> <code class="docutils literal notranslate"><span class="pre">types.int64</span></code></p></td>
<td><p>Not supported on devices that lack FP64 support</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">dpnp.bitwise_and</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">types.int32</span></code> <code class="docutils literal notranslate"><span class="pre">types.int64</span></code></p></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">dpnp.bitwise_or</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">types.int32</span></code> <code class="docutils literal notranslate"><span class="pre">types.int64</span></code></p></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">dpnp.bitwise_xor</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">types.int32</span></code> <code class="docutils literal notranslate"><span class="pre">types.int64</span></code></p></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">dpnp.copysign</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">types.float32</span></code> <code class="docutils literal notranslate"><span class="pre">types.float64</span></code></p></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">dpnp.divide</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">types.float32</span></code> <code class="docutils literal notranslate"><span class="pre">types.float64</span></code></p></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">dpnp.equal</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">types.float32</span></code> <code class="docutils literal notranslate"><span class="pre">types.float64</span></code> <code class="docutils literal notranslate"><span class="pre">types.int32</span></code> <code class="docutils literal notranslate"><span class="pre">types.int64</span></code></p></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">dpnp.floor_divide</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">types.float32</span></code> <code class="docutils literal notranslate"><span class="pre">types.float64</span></code> <code class="docutils literal notranslate"><span class="pre">types.int32</span></code> <code class="docutils literal notranslate"><span class="pre">types.int64</span></code></p></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">dpnp.fmax</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">types.float32</span></code> <code class="docutils literal notranslate"><span class="pre">types.float64</span></code> <code class="docutils literal notranslate"><span class="pre">types.int32</span></code> <code class="docutils literal notranslate"><span class="pre">types.int64</span></code></p></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">dpnp.fmin</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">types.float32</span></code> <code class="docutils literal notranslate"><span class="pre">types.float64</span></code> <code class="docutils literal notranslate"><span class="pre">types.int32</span></code> <code class="docutils literal notranslate"><span class="pre">types.int64</span></code></p></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">dpnp.fmod</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">types.float32</span></code> <code class="docutils literal notranslate"><span class="pre">types.float64</span></code></p></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">dpnp.greater</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">types.float32</span></code> <code class="docutils literal notranslate"><span class="pre">types.float64</span></code> <code class="docutils literal notranslate"><span class="pre">types.int32</span></code> <code class="docutils literal notranslate"><span class="pre">types.int64</span></code></p></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">dpnp.greater_equal</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">types.float32</span></code> <code class="docutils literal notranslate"><span class="pre">types.float64</span></code> <code class="docutils literal notranslate"><span class="pre">types.int32</span></code> <code class="docutils literal notranslate"><span class="pre">types.int64</span></code></p></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">dpnp.hypot</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">types.float32</span></code> <code class="docutils literal notranslate"><span class="pre">types.float64</span></code></p></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">dpnp.left_shift</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">types.int32</span></code> <code class="docutils literal notranslate"><span class="pre">types.int64</span></code></p></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">dpnp.less</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">types.float32</span></code> <code class="docutils literal notranslate"><span class="pre">types.float64</span></code> <code class="docutils literal notranslate"><span class="pre">types.int32</span></code> <code class="docutils literal notranslate"><span class="pre">types.int64</span></code></p></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">dpnp.less_equal</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">types.float32</span></code> <code class="docutils literal notranslate"><span class="pre">types.float64</span></code> <code class="docutils literal notranslate"><span class="pre">types.int32</span></code> <code class="docutils literal notranslate"><span class="pre">types.int64</span></code></p></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">dpnp.logical_and</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">types.float32</span></code> <code class="docutils literal notranslate"><span class="pre">types.float64</span></code> <code class="docutils literal notranslate"><span class="pre">types.int32</span></code> <code class="docutils literal notranslate"><span class="pre">types.int64</span></code></p></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">dpnp.logical_or</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">types.float32</span></code> <code class="docutils literal notranslate"><span class="pre">types.float64</span></code> <code class="docutils literal notranslate"><span class="pre">types.int32</span></code> <code class="docutils literal notranslate"><span class="pre">types.int64</span></code></p></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">dpnp.logical_xor</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">types.float32</span></code> <code class="docutils literal notranslate"><span class="pre">types.float64</span></code> <code class="docutils literal notranslate"><span class="pre">types.int32</span></code> <code class="docutils literal notranslate"><span class="pre">types.int64</span></code></p></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">dpnp.maximum</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">types.float32</span></code> <code class="docutils literal notranslate"><span class="pre">types.float64</span></code> <code class="docutils literal notranslate"><span class="pre">types.int32</span></code> <code class="docutils literal notranslate"><span class="pre">types.int64</span></code></p></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">dpnp.minimum</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">types.float32</span></code> <code class="docutils literal notranslate"><span class="pre">types.float64</span></code> <code class="docutils literal notranslate"><span class="pre">types.int32</span></code> <code class="docutils literal notranslate"><span class="pre">types.int64</span></code></p></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">dpnp.mod</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">types.int32</span></code> <code class="docutils literal notranslate"><span class="pre">types.int64</span></code></p></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">dpnp.multiply</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">types.float32</span></code> <code class="docutils literal notranslate"><span class="pre">types.float64</span></code> <code class="docutils literal notranslate"><span class="pre">types.int32</span></code> <code class="docutils literal notranslate"><span class="pre">types.int64</span></code></p></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">dpnp.not_equal</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">types.float32</span></code> <code class="docutils literal notranslate"><span class="pre">types.float64</span></code> <code class="docutils literal notranslate"><span class="pre">types.int32</span></code> <code class="docutils literal notranslate"><span class="pre">types.int64</span></code></p></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">dpnp.power</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">types.float32</span></code> <code class="docutils literal notranslate"><span class="pre">types.float64</span></code></p></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">dpnp.remainder</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">types.float32</span></code> <code class="docutils literal notranslate"><span class="pre">types.float64</span></code> <code class="docutils literal notranslate"><span class="pre">types.int32</span></code> <code class="docutils literal notranslate"><span class="pre">types.int64</span></code></p></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">dpnp.right_shift</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">types.float32</span></code> <code class="docutils literal notranslate"><span class="pre">types.float64</span></code></p></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">dpnp.subtract</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">types.float32</span></code> <code class="docutils literal notranslate"><span class="pre">types.float64</span></code> <code class="docutils literal notranslate"><span class="pre">types.int32</span></code> <code class="docutils literal notranslate"><span class="pre">types.int64</span></code></p></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">dpnp.true_divide</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">types.float32</span></code> <code class="docutils literal notranslate"><span class="pre">types.float64</span></code></p></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">dpnp.abs</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">types.float32</span></code> <code class="docutils literal notranslate"><span class="pre">types.float64</span></code> <code class="docutils literal notranslate"><span class="pre">types.int32</span></code> <code class="docutils literal notranslate"><span class="pre">types.int64</span></code></p></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">dpnp.absolute</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">types.float32</span></code> <code class="docutils literal notranslate"><span class="pre">types.float64</span></code> <code class="docutils literal notranslate"><span class="pre">types.int32</span></code> <code class="docutils literal notranslate"><span class="pre">types.int64</span></code></p></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">dpnp.arccos</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">types.float32</span></code> <code class="docutils literal notranslate"><span class="pre">types.float64</span></code></p></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">dpnp.arccosh</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">types.float32</span></code> <code class="docutils literal notranslate"><span class="pre">types.float64</span></code></p></td>
<td><p>Not supported on Intel Xe (Gen12) GPUs</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">dpnp.arcsin</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">types.float32</span></code> <code class="docutils literal notranslate"><span class="pre">types.float64</span></code></p></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">dpnp.arcsinh</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">types.float32</span></code> <code class="docutils literal notranslate"><span class="pre">types.float64</span></code></p></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">dpnp.arctan</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">types.float32</span></code> <code class="docutils literal notranslate"><span class="pre">types.float64</span></code></p></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">dpnp.arctanh</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">types.float32</span></code> <code class="docutils literal notranslate"><span class="pre">types.float64</span></code></p></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">dpnp.bitwise_not</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">types.int32</span></code> <code class="docutils literal notranslate"><span class="pre">types.int64</span></code></p></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">dpnp.cbrt</span></code></p></td>
<td><p>N/A</p></td>
<td><p>Not supported</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">dpnp.ceil</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">types.float32</span></code> <code class="docutils literal notranslate"><span class="pre">types.float64</span></code></p></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">dpnp.conjugate</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">types.float32</span></code> <code class="docutils literal notranslate"><span class="pre">types.float64</span></code> <code class="docutils literal notranslate"><span class="pre">types.int32</span></code> <code class="docutils literal notranslate"><span class="pre">types.int64</span></code></p></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">dpnp.cos</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">types.float32</span></code> <code class="docutils literal notranslate"><span class="pre">types.float64</span></code></p></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">dpnp.cosh</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">types.float32</span></code> <code class="docutils literal notranslate"><span class="pre">types.float64</span></code></p></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">dpnp.deg2rad</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">types.float32</span></code> <code class="docutils literal notranslate"><span class="pre">types.float64</span></code></p></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">dpnp.degrees</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">types.float32</span></code> <code class="docutils literal notranslate"><span class="pre">types.float64</span></code></p></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">dpnp.erf</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">types.float32</span></code> <code class="docutils literal notranslate"><span class="pre">types.float64</span></code></p></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">dpnp.exp</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">types.float32</span></code> <code class="docutils literal notranslate"><span class="pre">types.float64</span></code></p></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">dpnp.exp2</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">types.float32</span></code> <code class="docutils literal notranslate"><span class="pre">types.float64</span></code></p></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">dpnp.expm1</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">types.float32</span></code> <code class="docutils literal notranslate"><span class="pre">types.float64</span></code></p></td>
<td><p>Not supported on Intel Xe (Gen12) GPUs</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">dpnp.fabs</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">types.float32</span></code> <code class="docutils literal notranslate"><span class="pre">types.float64</span></code></p></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">dpnp.floor</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">types.float32</span></code> <code class="docutils literal notranslate"><span class="pre">types.float64</span></code></p></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">dpnp.frexp</span></code></p></td>
<td><p>N/A</p></td>
<td><p>Not supported</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">dpnp.invert</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">types.int32</span></code> <code class="docutils literal notranslate"><span class="pre">types.int64</span></code></p></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">dpnp.isfinite</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">types.float32</span></code> <code class="docutils literal notranslate"><span class="pre">types.float64</span></code> <code class="docutils literal notranslate"><span class="pre">types.int32</span></code> <code class="docutils literal notranslate"><span class="pre">types.int64</span></code></p></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">dpnp.isinf</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">types.float32</span></code> <code class="docutils literal notranslate"><span class="pre">types.float64</span></code> <code class="docutils literal notranslate"><span class="pre">types.int32</span></code> <code class="docutils literal notranslate"><span class="pre">types.int64</span></code></p></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">dpnp.isnan</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">types.float32</span></code> <code class="docutils literal notranslate"><span class="pre">types.float64</span></code> <code class="docutils literal notranslate"><span class="pre">types.int32</span></code> <code class="docutils literal notranslate"><span class="pre">types.int64</span></code></p></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">dpnp.log</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">types.float32</span></code> <code class="docutils literal notranslate"><span class="pre">types.float64</span></code></p></td>
<td><p>Not supported on Intel Xe (Gen12) GPUs</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">dpnp.log10</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">types.float32</span></code> <code class="docutils literal notranslate"><span class="pre">types.float64</span></code></p></td>
<td><p>Not supported on Intel Xe (Gen12) GPUs</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">dpnp.log1p</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">types.float32</span></code> <code class="docutils literal notranslate"><span class="pre">types.float64</span></code></p></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">dpnp.log2</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">types.float32</span></code> <code class="docutils literal notranslate"><span class="pre">types.float64</span></code></p></td>
<td><p>Not supported on Intel Xe (Gen12) GPUs</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">dpnp.log2</span></code></p></td>
<td><p>N/A</p></td>
<td><p>Not supported</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">dpnp.logical_not</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">types.float32</span></code> <code class="docutils literal notranslate"><span class="pre">types.float64</span></code> <code class="docutils literal notranslate"><span class="pre">types.int32</span></code> <code class="docutils literal notranslate"><span class="pre">types.int64</span></code></p></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">dpnp.logaddexp</span></code></p></td>
<td><p>N/A</p></td>
<td><p>Not supported</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">dpnp.logaddexp2</span></code></p></td>
<td><p>N/A</p></td>
<td><p>Not supported</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">dpnp.negative</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">types.float32</span></code> <code class="docutils literal notranslate"><span class="pre">types.float64</span></code> <code class="docutils literal notranslate"><span class="pre">types.int32</span></code> <code class="docutils literal notranslate"><span class="pre">types.int64</span></code></p></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">dpnp.rad2deg</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">types.float32</span></code> <code class="docutils literal notranslate"><span class="pre">types.float64</span></code></p></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">dpnp.radians</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">types.float32</span></code> <code class="docutils literal notranslate"><span class="pre">types.float64</span></code></p></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">dpnp.reciprocal</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">types.float32</span></code> <code class="docutils literal notranslate"><span class="pre">types.float64</span></code></p></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">dpnp.sign</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">types.float32</span></code> <code class="docutils literal notranslate"><span class="pre">types.float64</span></code> <code class="docutils literal notranslate"><span class="pre">types.int32</span></code> <code class="docutils literal notranslate"><span class="pre">types.int64</span></code></p></td>
<td><p>Not supported on Intel Xe (Gen12) GPUs</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">dpnp.sin</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">types.float32</span></code> <code class="docutils literal notranslate"><span class="pre">types.float64</span></code></p></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">dpnp.sinh</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">types.float32</span></code> <code class="docutils literal notranslate"><span class="pre">types.float64</span></code></p></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">dpnp.sqrt</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">types.float32</span></code> <code class="docutils literal notranslate"><span class="pre">types.float64</span></code></p></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">dpnp.square</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">types.float32</span></code> <code class="docutils literal notranslate"><span class="pre">types.float64</span></code> <code class="docutils literal notranslate"><span class="pre">types.int32</span></code> <code class="docutils literal notranslate"><span class="pre">types.int64</span></code></p></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">dpnp.tan</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">types.float32</span></code> <code class="docutils literal notranslate"><span class="pre">types.float64</span></code></p></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">dpnp.tanh</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">types.float32</span></code> <code class="docutils literal notranslate"><span class="pre">types.float64</span></code></p></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">dpnp.trunc</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">types.float32</span></code> <code class="docutils literal notranslate"><span class="pre">types.float64</span></code></p></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="operators">
<h3>Operators<a class="headerlink" href="#operators" title="Link to this heading">#</a></h3>
<p>List of supported Python operators that can be used in a <code class="docutils literal notranslate"><span class="pre">kernel</span></code> or
<code class="docutils literal notranslate"><span class="pre">device_func</span></code> decorated function.</p>
<div class="table-wrapper docutils container" id="id5">
<table class="docutils align-default" id="id5">
<caption><span class="caption-text">Current support matrix of Python operators</span><a class="headerlink" href="#id5" title="Link to this table">#</a></caption>
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head"><p>Operator</p></th>
<th class="head"><p>Note</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Addition</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">+</span></code></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>Multiplication</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">*</span></code></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>Subtraction</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>Division</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">/</span></code></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>Floor Division</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">//</span></code></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>Modulo</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">%</span></code></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>Exponent</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">**</span></code></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>In-place Addition</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">+=</span></code></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>In-place Subtraction</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-=</span></code></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>In-place Division</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">/=</span></code></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>In-place Floor Division</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">//=</span></code></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>In-place Modulo</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">%=</span></code></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>In-place Exponent</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">**=</span></code></p></td>
<td><p>Only supported on OpenCL CPU devices</p></td>
</tr>
<tr class="row-odd"><td><p>Bitwise And</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">&amp;</span></code></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>Bitwise Left Shift</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">&lt;&lt;</span></code></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>Bitwise Right Shift</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">&gt;&gt;</span></code></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>Bitwise Or</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">|</span></code></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>Bitwise Exclusive Or</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">^</span></code></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>In-place Bitwise And</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">&amp;=</span></code></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>In-place Bitwise Left Shift</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">&lt;&lt;=</span></code></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>In-place Bitwise Right Shift</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">&gt;&gt;=</span></code></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>In-place Bitwise Or</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">|=</span></code></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>In-place Bitwise Exclusive Or</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">^=</span></code></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>Negation</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>Complement</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">~</span></code></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>Pos</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">+</span></code></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>Less Than</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">&lt;</span></code></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>Less Than Equal</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">&lt;=</span></code></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>Greater Than</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">&gt;</span></code></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>Greater Than Equal</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">&gt;=</span></code></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>Equal To</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">==</span></code></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>Not Equal To</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">!=</span></code></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>Matmul</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">&#64;</span></code></p></td>
<td><p><strong>Not supported</strong></p></td>
</tr>
<tr class="row-odd"><td><p>In-place Matmul</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">&#64;=</span></code></p></td>
<td><p><strong>Not supported</strong></p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="general-python-features">
<h3>General Python features<a class="headerlink" href="#general-python-features" title="Link to this heading">#</a></h3>
<p>A kapi function when run in the purely interpreted mode by the CPython
interpreter is a regular Python function, and as such in theory any Python
feature can be used in the body of the function. In practice, to be
JIT compilable and executable on a device only a subset of Python language
features are supported in a kapi function. The restriction stems from both
limitations in the Numba compiler tooling and also from the device-specific
calling convention and other restrictions applied by a device’s ABI.</p>
<p>This section provides a partial support matrix for Python features with respect
to their usage in a kapi function.</p>
<section id="built-in-types">
<h4>Built-in types<a class="headerlink" href="#built-in-types" title="Link to this heading">#</a></h4>
<p><strong>Supported Types</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">int</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">float</span></code></p></li>
</ul>
<p><strong>Unsupported Types</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">complex</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">bool</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">None</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">tuple</span></code></p></li>
</ul>
</section>
<section id="built-in-functions">
<h4>Built-in functions<a class="headerlink" href="#built-in-functions" title="Link to this heading">#</a></h4>
<p>The following built-in functions are supported:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">abs()</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">float</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">int</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">len()</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">range()</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">round()</span></code></p></li>
</ul>
</section>
<section id="unsupported-constructs">
<h4>Unsupported Constructs<a class="headerlink" href="#unsupported-constructs" title="Link to this heading">#</a></h4>
<p>The following Python constructs are <strong>not supported</strong>:</p>
<ul class="simple">
<li><p>Exception handling (<code class="docutils literal notranslate"><span class="pre">try</span> <span class="pre">..</span> <span class="pre">except</span></code>, <code class="docutils literal notranslate"><span class="pre">try</span> <span class="pre">..</span> <span class="pre">finally</span></code>)</p></li>
<li><p>Context management (the <code class="docutils literal notranslate"><span class="pre">with</span></code> statement)</p></li>
<li><p>Comprehensions (either list, dict, set or generator comprehensions)</p></li>
<li><p>Generator (any <code class="docutils literal notranslate"><span class="pre">yield</span></code> statements)</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">raise</span></code> statement</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">assert</span></code> statement</p></li>
</ul>
</section>
</section>
</section>
<section id="advanced-concepts">
<h2>Advanced concepts<a class="headerlink" href="#advanced-concepts" title="Link to this heading">#</a></h2>
<section id="local-memory-allocation">
<h3>Local memory allocation<a class="headerlink" href="#local-memory-allocation" title="Link to this heading">#</a></h3>
</section>
<section id="private-memory-allocation">
<h3>Private memory allocation<a class="headerlink" href="#private-memory-allocation" title="Link to this heading">#</a></h3>
</section>
<section id="group-barrier-synchronization">
<h3>Group barrier synchronization<a class="headerlink" href="#group-barrier-synchronization" title="Link to this heading">#</a></h3>
</section>
<section id="atomic-operations">
<h3>Atomic operations<a class="headerlink" href="#atomic-operations" title="Link to this heading">#</a></h3>
</section>
<section id="async-kernel-execution">
<span id="launching-an-async-kernel"></span><h3>Async kernel execution<a class="headerlink" href="#async-kernel-execution" title="Link to this heading">#</a></h3>
</section>
<section id="specializing-a-kernel-or-a-device-func">
<h3>Specializing a kernel or a device_func<a class="headerlink" href="#specializing-a-kernel-or-a-device-func" title="Link to this heading">#</a></h3>
</section>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="../debugging/index.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Debugging with Intel® Distribution for GDB*</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="../index.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Tutorials</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2020-2024, Intel Corporation
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            <div class="icons">
              <a class="muted-link " href="https://github.com/IntelPython/numba-dpex" aria-label="GitHub"></a>
              
            </div>
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Kernel Programming</a><ul>
<li><a class="reference internal" href="#core-concepts">Core concepts</a><ul>
<li><a class="reference internal" href="#writing-a-range-kernel">Writing a <em>range</em> kernel</a></li>
<li><a class="reference internal" href="#writing-an-nd-range-kernel">Writing an <em>nd-range</em> kernel</a></li>
<li><a class="reference internal" href="#launching-a-kernel">Launching a kernel</a></li>
<li><a class="reference internal" href="#the-device-func-decorator">The <code class="docutils literal notranslate"><span class="pre">device_func</span></code> decorator</a></li>
<li><a class="reference internal" href="#supported-types-of-kernel-argument">Supported types of kernel argument</a><ul>
<li><a class="reference internal" href="#supported-array-types">Supported array types</a></li>
<li><a class="reference internal" href="#scalar-types">Scalar types</a></li>
<li><a class="reference internal" href="#dlpack-support">DLPack support</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#supported-python-features">Supported Python features</a><ul>
<li><a class="reference internal" href="#mathematical-operations">Mathematical operations</a></li>
<li><a class="reference internal" href="#operators">Operators</a></li>
<li><a class="reference internal" href="#general-python-features">General Python features</a><ul>
<li><a class="reference internal" href="#built-in-types">Built-in types</a></li>
<li><a class="reference internal" href="#built-in-functions">Built-in functions</a></li>
<li><a class="reference internal" href="#unsupported-constructs">Unsupported Constructs</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#advanced-concepts">Advanced concepts</a><ul>
<li><a class="reference internal" href="#local-memory-allocation">Local memory allocation</a></li>
<li><a class="reference internal" href="#private-memory-allocation">Private memory allocation</a></li>
<li><a class="reference internal" href="#group-barrier-synchronization">Group barrier synchronization</a></li>
<li><a class="reference internal" href="#atomic-operations">Atomic operations</a></li>
<li><a class="reference internal" href="#async-kernel-execution">Async kernel execution</a></li>
<li><a class="reference internal" href="#specializing-a-kernel-or-a-device-func">Specializing a kernel or a device_func</a></li>
</ul>
</li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="../../_static/documentation_options.js?v=5929fcd5"></script>
    <script src="../../_static/doctools.js?v=888ff710"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/scripts/furo.js?v=32e29ea5"></script>
    </body>
</html>