<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-LGGL0NJK6P"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-LGGL0NJK6P');
    </script>
    
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Docker &mdash; numba-dpex 0.21.0+23.g7962257d documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/sphinx_highlight.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="numba-dpex for numba.cuda Developers" href="migrating_from_numba_cuda.html" />
    <link rel="prev" title="Common issues and tips" href="debugging/common_issues.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            numba-dpex
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Core Features</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../CoreFeatures.html">Code-generation based on a device</a></li>
<li class="toctree-l1"><a class="reference internal" href="../CoreFeatures.html#automatic-offload-of-numpy-expressions">Automatic offload of NumPy expressions</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">User Guides</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="getting_started.html"> Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="kernel_programming_guide/index.html"> Direct kernel programming</a></li>
<li class="toctree-l1"><a class="reference internal" href="debugging/index.html"> Debugging with GDB</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#"> Docker</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#building">Building</a></li>
<li class="toctree-l2"><a class="reference internal" href="#running-prebuilt-images">Running prebuilt images</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="migrating_from_numba_cuda.html"> numba-dpex for numba.cuda Programmers</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Developer Guides</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../developer_guides/dpnp_integration.html">dpnp integration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../developer_guides/tools.html">Debugging the compilation pipeline</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">numba-dpex</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Docker</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/user_guides/docker.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="docker">
<span id="id1"></span><h1>Docker<a class="headerlink" href="#docker" title="Permalink to this heading"></a></h1>
<p>Numba dpex now delivers docker support.
Dockerfile is capable of building numba-dpex as well as direct dependencies for it:
dpctl and dpnp.
There are several prebuilt images available: for trying numba_dpex and
for building numba-dpex.</p>
<section id="building">
<h2>Building<a class="headerlink" href="#building" title="Permalink to this heading"></a></h2>
<p>Numba dpex ships with multistage Dockerfile, which means there are
different <a class="reference external" href="https://docs.docker.com/build/building/multi-stage/#stop-at-a-specific-build-stage">targets</a> available for build. The most useful ones:</p>
<ul class="simple">
<li><p>runtime</p></li>
<li><p>runtime-gpu</p></li>
<li><p>numba-dpex-builder-runtime</p></li>
<li><p>numba-dpex-builder-runtime-gpu</p></li>
</ul>
<p>To build docker image</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>docker<span class="w"> </span>build<span class="w"> </span>--target<span class="w"> </span>runtime<span class="w"> </span>-t<span class="w"> </span>numba-dpex:runtime<span class="w"> </span>./
</pre></div>
</div>
<p>To run docker image</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>docker<span class="w"> </span>run<span class="w"> </span>-it<span class="w"> </span>--rm<span class="w"> </span>numba-dpex:runtime
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you are building docker image with gpu support it will calls github api to get
latest versions of intel gpu drivers. You may face Github API call limits. To avoid
this, you can pass your github credentials to increase this limit. You can do it
by providing
<a class="reference external" href="https://docs.docker.com/engine/reference/commandline/build/#build-arg">build args</a>
<code class="docutils literal notranslate"><span class="pre">GITHUB_USER</span></code> and <code class="docutils literal notranslate"><span class="pre">GITHUB_PASSWORD</span></code>. You can use
<cite>access token &lt;https://docs.github.com/en/authentication/keeping-your-account-and-data-secure/creating-a-personal-access-token&gt;</cite>
instead of the password:</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In case you are building docker image behind firewall and your internet access
requires proxy, you can provide proxy
<a class="reference external" href="https://docs.docker.com/engine/reference/commandline/build/#build-arg">build args</a>
<code class="docutils literal notranslate"><span class="pre">http_proxy</span></code> and <code class="docutils literal notranslate"><span class="pre">https_proxy</span></code>. Please note, that these args must be lowercase.</p>
</div>
<p>Dockerfile supports different python versions. To select the one you want, simply set
<code class="docutils literal notranslate"><span class="pre">PYTHON_VERSION</span></code> build arg. By default docker image is based on official python image
based on slim debian, so the requested python version must be from the available python
docker images. In case you want to build on images on custom image you have to pass
<code class="docutils literal notranslate"><span class="pre">BASE_IMAGE</span></code> environment variable. Be aware that Dockerfile is based on debian so any
base image should be debian based, like debian or ubuntu.</p>
<p>Build arguments that could be useful:</p>
<ul class="simple">
<li><p>PYTHON_VERSION</p></li>
<li><p>CR_TAG</p></li>
<li><p>IGC_TAG</p></li>
<li><p>CM_TAG</p></li>
<li><p>L0_TAG</p></li>
<li><p>ONEAPI_VERSION</p></li>
<li><p>DPCTL_GIT_BRANCH</p></li>
<li><p>DPCTL_GIT_URL</p></li>
<li><p>DPNP_GIT_BRANCH</p></li>
<li><p>DPNP_GIT_URL</p></li>
<li><p>NUMBA_DPEX_GIT_BRANCH</p></li>
<li><p>NUMBA_DPEX_GIT_URL</p></li>
<li><p>CMAKE_VERSION</p></li>
<li><p>CMAKE_VERSION_BUILD</p></li>
<li><p>INTEL_NUMPY_VERSION</p></li>
<li><p>INTEL_NUMBA_VERSION</p></li>
<li><p>CYTHON_VERSION</p></li>
<li><p>SCIKIT_BUILD_VERSION</p></li>
<li><p>http_proxy</p></li>
<li><p>https_proxy</p></li>
<li><p>GITHUB_USER</p></li>
<li><p>GITHUB_PASSWORD</p></li>
<li><p>BASE_IMAGE</p></li>
</ul>
<p>Refer to Dockerfile to see all available</p>
</section>
<section id="running-prebuilt-images">
<h2>Running prebuilt images<a class="headerlink" href="#running-prebuilt-images" title="Permalink to this heading"></a></h2>
<p>An easy way you can try <code class="docutils literal notranslate"><span class="pre">numba_dpex</span></code> is by using prebuilt images.
There are several prebuilt images available:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">runtime</span></code> package that provides runtime experience</p></li>
</ul>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>ghcr.io/intelpython/numba-dpex/runtime:&lt;numba_dpex_version&gt;-py&lt;python_version&gt;[-gpu]
</pre></div>
</div>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">builder</span></code> package that provides building experience</p></li>
</ul>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>ghcr.io/intelpython/numba-dpex/builder:&lt;numba_dpex_version&gt;-py&lt;python_version&gt;[-gpu]
</pre></div>
</div>
<ul class="simple">
<li><p>you can also see <code class="docutils literal notranslate"><span class="pre">stages</span></code> package, but it is used mostly for building stages.</p></li>
</ul>
<p>You can use them to build your own docker that is built on top of one of them.</p>
<p>To try out numba dpex simply run:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>docker<span class="w"> </span>run<span class="w"> </span>--rm<span class="w"> </span>-it<span class="w"> </span>ghcr.io/intelpython/numba-dpex/runtime:0.20.0-py3.10<span class="w"> </span>bash
</pre></div>
</div>
<p>Within the container you can check available devices by running</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>sycl-ls
</pre></div>
</div>
<p>or</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>python<span class="w"> </span>-c<span class="w"> </span><span class="s2">&quot;import dpctl; dpctl.lsplatform();&quot;</span>.
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you want to enable GPU you need to pass it within container and use <code class="docutils literal notranslate"><span class="pre">*-gpu</span></code> tag.</p>
<p>For passing GPU into container on linux use arguments <code class="docutils literal notranslate"><span class="pre">--device=/dev/dri</span></code>.
However if you are using WSL you need to pass
<code class="docutils literal notranslate"><span class="pre">--device=/dev/dxg</span> <span class="pre">-v</span> <span class="pre">/usr/lib/wsl:/usr/lib/wsl</span></code> instead.</p>
</div>
<p>So, for example, if you want to run numba dpex container with GPU support on WSL:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>docker<span class="w"> </span>run<span class="w"> </span>--rm<span class="w"> </span>-it<span class="w"> </span><span class="se">\</span>
--device<span class="o">=</span>/dev/dxg<span class="w"> </span>-v<span class="w"> </span>/usr/lib/wsl:/usr/lib/wsl<span class="w"> </span><span class="se">\</span>
ghcr.io/intelpython/numba-dpex/runtime:0.20.0-py3.10-gpu
</pre></div>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="debugging/common_issues.html" class="btn btn-neutral float-left" title="Common issues and tips" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="migrating_from_numba_cuda.html" class="btn btn-neutral float-right" title="numba-dpex for numba.cuda Developers" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021-2023 Intel Corporation.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>