
numba_dpex.core.utils
=====================

.. py:module:: numba_dpex.core.utils


Subpackages
-----------
.. toctree::
   :titlesonly:
   :maxdepth: 3

   kernel_templates/index.rst


Overview
--------

.. list-table:: Classes
   :header-rows: 0
   :widths: auto
   :class: summarytable

   * - :py:obj:`SyclUSMArrayInterface <numba_dpex.core.utils.SyclUSMArrayInterface>`
     - Stores as attributes the information extracted from a


.. list-table:: Function
   :header-rows: 0
   :widths: auto
   :class: summarytable

   * - :py:obj:`build_key <numba_dpex.core.utils.build_key>`\ (\*args)
     - Constructs key from variable list of args
   * - :py:obj:`create_func_hash <numba_dpex.core.utils.create_func_hash>`\ (pyfunc)
     - Creates a tuple of sha256 hashes out of code and
   * - :py:obj:`strip_usm_metadata <numba_dpex.core.utils.strip_usm_metadata>`\ (argtypes)
     - Convert the USMNdArray to an abridged type that disregards the
   * - :py:obj:`get_info_from_suai <numba_dpex.core.utils.get_info_from_suai>`\ (obj)
     - Extracts the metadata of an object of type UsmNdArray using the objects



Classes
-------

.. py:class:: SyclUSMArrayInterface(data, writable, size, shape, dimensions, itemsize, strides, dtype, usm_type, device, queue)

   Stores as attributes the information extracted from a
   __sycl_usm_array_interface__ dictionary as defined by dpctl.memory.Memory*
   classes.




Functions
---------
.. py:function:: build_key(*args)

   Constructs key from variable list of args

   :param \*args: List of components to construct key

   :returns: Tuple of args


.. py:function:: create_func_hash(pyfunc)

   Creates a tuple of sha256 hashes out of code and
   variable bytes extracted from the compiled funtion.

   :param pyfunc: Python function object

   :returns: Tuple of hashes of code and variable bytes


.. py:function:: strip_usm_metadata(argtypes)

   Convert the USMNdArray to an abridged type that disregards the
   usm_type, device, queue, address space attributes.

   :param argtypes: List of types

   :returns: Tuple of types after removing USM metadata from USMNdArray type


.. py:function:: get_info_from_suai(obj)

   Extracts the metadata of an object of type UsmNdArray using the objects
   __sycl_usm_array_interface__ (SUAI) attribute.

   The ``dpctl.memory.as_usm_memory`` function converts the array-like
   object into a dpctl.memory.USMMemory object. Using the ``as_usm_memory``
   is an implicit way to verify if the array-like object is a legal
   SYCL USM memory back Python object that can be passed to a dpex kernel.

   :param obj: array-like object with a SUAI attribute.

   :returns: A SyclUSMArrayInterface object





